{"jobsTree":{"id":131427,"name":"ROOT","children":[{"id":131480,"name":"Beanstalk CRM","children":[{"id":158435,"name":"Incremental ETL","children":[],"jobs":[{"id":165768,"name":"AuditRecord INIT","description":"","type":"TRANSFORMATION"},{"id":163078,"name":"ETL Driver CRM_BST","description":"","type":"ORCHESTRATION"},{"id":166812,"name":"Audit Updater","description":"","type":"TRANSFORMATION"},{"id":179888,"name":"Schema Utility Checker","description":"","type":"ORCHESTRATION"},{"id":180059,"name":"ETL Job Iterate","description":"","type":"ORCHESTRATION"},{"id":232419,"name":"Incremental Loader","description":"","type":"ORCHESTRATION"},{"id":285024,"name":"ETL Driver CRM_BLE","description":"","type":"ORCHESTRATION"},{"id":299583,"name":"Vacuum BLE Tables","description":null,"type":"ORCHESTRATION"},{"id":179759,"name":"Incremental Loader With Landing","description":"","type":"ORCHESTRATION"},{"id":308160,"name":"Vacuum BST Tables","description":"","type":"ORCHESTRATION"},{"id":311354,"name":"Err Handler Orch","description":null,"type":"ORCHESTRATION"},{"id":311357,"name":"Err Handler Trans","description":null,"type":"TRANSFORMATION"},{"id":311725,"name":"Copy of ETL Driver CRM_BLE","description":"","type":"ORCHESTRATION"},{"id":314462,"name":"Incremental Loader Set Lower Limit","description":"","type":"ORCHESTRATION"}]},{"id":190583,"name":"Copy tables across Instances","children":[],"jobs":[{"id":190589,"name":"Unload Table","description":"","type":"ORCHESTRATION"},{"id":190644,"name":"Load Table","description":null,"type":"ORCHESTRATION"},{"id":292879,"name":"Orch Job","description":null,"type":"ORCHESTRATION"},{"id":292884,"name":"Trans Job","description":null,"type":"TRANSFORMATION"}]}],"jobs":[]}],"jobs":[]},"orchestrationJobs":[{"id":163078,"revision":111,"created":1512265246457,"timestamp":1512265246457,"components":{"163080":{"id":163080,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1227580116,"x":-2199,"y":-190,"width":32,"height":16,"inputConnectorIDs":[163082],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job Iterator"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_crm_bst_jobs_to_run"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_id"},"2":{"slot":2,"type":"STRING","value":"etl_job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"crm_customer_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"table_name"},"2":{"slot":2,"type":"STRING","value":"table_name"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"},"2":{"slot":2,"type":"STRING","value":"job_order"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"source_db"},"2":{"slot":2,"type":"STRING","value":"source_db"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"source_server"},"2":{"slot":2,"type":"STRING","value":"source_server"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_column"},"2":{"slot":2,"type":"STRING","value":"max_create_column"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_column"},"2":{"slot":2,"type":"STRING","value":"max_update_column"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"max_date_columns"},"2":{"slot":2,"type":"STRING","value":"get_max_dates_sql"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"match_keys"},"2":{"slot":2,"type":"STRING","value":"match_keys"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"matched"},"2":{"slot":2,"type":"STRING","value":"matched_keys"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"matched_is_null"},"2":{"slot":2,"type":"STRING","value":"matched_is_null"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Ordering","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Break on Failure","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"7":{"slot":7,"name":"Concurrency","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[163102],"inputIterationConnectorIDs":[]},"163079":{"id":163079,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-2402,"y":-194,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[163082],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"163101":{"id":163101,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-2032,"y":-64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Orchestration Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"No input provided"}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[163102]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"163082":{"id":163082,"sourceID":163079,"targetID":163080}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"163102":{"id":163102,"sourceID":163080,"targetID":163101}},"noteConnectors":{},"canUndo":true,"undoCommand":"Move Components","undoCreated":1512265244439,"canRedo":false,"redoCommand":"","redoCreated":1509577791584,"notes":{"285229":{"id":285229,"x":-2127,"y":-231,"width":200,"height":50,"text":"Main Driver\nDoes: Iterates through a list of ETL Jobs and their respective ETL Processing properties.\nEach Job's properties are mapped to a local set of env. variables to process.\nThe list of jobs is generated from the view:  admin.vw_jobs_to_run\nNotes:\n"}}},{"id":179888,"revision":288,"created":1503943037019,"timestamp":1503943037019,"components":{"179891":{"id":179891,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1579,"y":-293,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[179958],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179893":{"id":179893,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1453,"y":-287,"width":32,"height":32,"inputConnectorIDs":[179958],"outputSuccessConnectorIDs":[180090],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"bashDebug1"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\necho $audit_completed\necho \"in table: \" $table_name\n#echo \"in job_id \" $etl_job_id\n#echo \"in max_create\" $max_create_date\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179896":{"id":179896,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1329,"y":-282,"width":32,"height":32,"inputConnectorIDs":[180090],"outputSuccessConnectorIDs":[179945],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179897":{"id":179897,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1198,"y":-284,"width":32,"height":32,"inputConnectorIDs":[179945],"outputSuccessConnectorIDs":[191056],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GetAuditId"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute(''' select coalesce(max(etl_audit_id),-1) from admin.etl_audit where job_id = '${etl_job_id}' ''' )\n\n \n\nimport datetime\n##import sys\n##print(sys.version) --> 2.7.1b3 (default:df42d5d6be04, Feb 3 2016, 03:22:46)\n\nresult = cursor.fetchone()[0]\nprint 'new auditid: ', result \n\ncontext.updateVariable('etl_audit_id',  result )\ncontext.updateVariable('audit_id_backup',  result )"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179902":{"id":179902,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1113,"y":13,"width":32,"height":32,"inputConnectorIDs":[191504],"outputSuccessConnectorIDs":[179948],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Staging Table Created"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'staging table created'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179903":{"id":179903,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-769,"y":272,"width":32,"height":32,"inputConnectorIDs":[180181],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Update final"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'schema utility complete'\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179904":{"id":179904,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-616,"y":-153,"width":32,"height":32,"inputConnectorIDs":[179953],"outputSuccessConnectorIDs":[190511],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Schema Column Checker"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\nschema_change_columns= ''\n\nlanding_cursor.execute('''\nSELECT  cast(column_name as varchar(50)) as my_column, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='landing' and table_name = '${table_name}' and column_name <> 'audit_id'\n  \n except \n \n SELECT  cast(column_name as varchar(50)) as my_column, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='staging' and table_name = '${table_name}' ''' )\n\n\nresults = landing_cursor.fetchall()\nif not results:\n\tcontext.updateVariable('schema_check',  1 )\n  \tprint(\"No Source Schema Change detected\")\n\nelse: \n  \tcontext.updateVariable('schema_check',  -1 )\n\tprint(\"Source Schema Change/s Detected\")  \n\tfor row in results:\n\t\tschema_change_columns = schema_change_columns + ' ' +  row[0] \t\n    \n\tprint schema_change_columns\n\tcontext.updateVariable('schema_change_columns',  schema_change_columns )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179905":{"id":179905,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-616,"y":81,"width":32,"height":32,"inputConnectorIDs":[190511],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[180119],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Is Stage Schema Current with Source"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179906":{"id":179906,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-917,"y":13,"width":32,"height":32,"inputConnectorIDs":[191387],"outputSuccessConnectorIDs":[191504],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create table in Staging Schema"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" ${schema_clone} \n\n\n\n"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179907":{"id":179907,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-917,"y":-160,"width":32,"height":32,"inputConnectorIDs":[191071],"outputSuccessConnectorIDs":[179928],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Staging"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${staging_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name='${table_name}' )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179908":{"id":179908,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-768,"y":-156,"width":32,"height":32,"inputConnectorIDs":[179928],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[179953],"outputFalseConnectorIDs":[179956],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does Staging table Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_exists"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179909":{"id":179909,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-771,"y":-66,"width":32,"height":32,"inputConnectorIDs":[179956],"outputSuccessConnectorIDs":[191415],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gen Staging Schema"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \nddl=''\naudit_columns=',etl_status smallint ,stage_id integer identity(1,1)'\nddl_delimiter=') DISTSTYLE'\n \nexec_sql =  ''' select replace(ddl, '\"${landing_schema}\".' ,'\"${staging_schema}\".' )\n\tfrom admin.vw_generate_tbl_ddl  \n\twhere schemaname= '${landing_schema}'  and tablename='${table_name}' '''\n   \nprint exec_sql\n\nlanding_cursor.execute(exec_sql )\nresults = landing_cursor.fetchall()\nprint results\nfor row in results:\n  #print ddl\n  ddl = ddl + ' ' + row[0] \n  \nddl = ddl.replace(ddl_delimiter, audit_columns + ddl_delimiter)  \nprint 'ddl: ' , ddl\ncontext.updateVariable('schema_clone',  ddl )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179910":{"id":179910,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1121,"y":90,"width":32,"height":32,"inputConnectorIDs":[179948],"outputSuccessConnectorIDs":[179930],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Datamart"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${datamart_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name='${table_name}' )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179911":{"id":179911,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-968,"y":176,"width":32,"height":32,"inputConnectorIDs":[179933],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[179955],"outputFalseConnectorIDs":[191196],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does DM Table Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179913":{"id":179913,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-488,"y":176,"width":32,"height":32,"inputConnectorIDs":[191211],"outputSuccessConnectorIDs":[180247],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTER Audit columns"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"alter table ${datamart_schema}.${table_name} drop column  stage_date;\nalter table ${datamart_schema}.${table_name} add  column  eff_date_start timestamp;\nalter table ${datamart_schema}.${table_name} add  column  eff_date_end   timestamp;\nalter table ${datamart_schema}.${table_name} add  column  is_active  smallint;"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179921":{"id":179921,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1117,"y":173,"width":32,"height":32,"inputConnectorIDs":[179930],"outputSuccessConnectorIDs":[179933],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 6"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 6 ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179922":{"id":179922,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-959,"y":275,"width":32,"height":32,"inputConnectorIDs":[179955],"outputSuccessConnectorIDs":[180181],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 7A"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 7A ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"180117":{"id":180117,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-419,"y":83,"width":32,"height":32,"inputConnectorIDs":[180119],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stage Schema out of Synch"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'stage schema out of synch: ' + '${schema_change_columns}'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"180242":{"id":180242,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-335,"y":179,"width":32,"height":32,"inputConnectorIDs":[180247],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Audit Update final"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'datamart table created'\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191034":{"id":191034,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1044,"y":-286,"width":32,"height":32,"inputConnectorIDs":[191056],"outputSuccessConnectorIDs":[191040],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Landing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${landing_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name='${table_name}' )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191037":{"id":191037,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-911,"y":-282,"width":32,"height":32,"inputConnectorIDs":[191040],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[191071],"outputFalseConnectorIDs":[191092],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does Landing table Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_exists"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191089":{"id":191089,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-716,"y":-294,"width":32,"height":32,"inputConnectorIDs":[191092],"outputSuccessConnectorIDs":[191119],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":-6,"mapTo":"audit_rowcount","validationStatus":"NONE","validationMessage":null},"2":{"slot":2,"fromId":-5,"mapTo":"audit_duration","validationStatus":"NONE","validationMessage":null},"3":{"slot":3,"fromId":-4,"mapTo":"audit_completed","validationStatus":"NONE","validationMessage":null},"4":{"slot":4,"fromId":-3,"mapTo":"audit_started","validationStatus":"NONE","validationMessage":null},"5":{"slot":5,"fromId":-2,"mapTo":"audit_status","validationStatus":"NONE","validationMessage":null},"6":{"slot":6,"fromId":-1,"mapTo":"audit_component","validationStatus":"NONE","validationMessage":null},"7":{"slot":7,"fromId":201,"mapTo":"audit_upload_time","validationStatus":"NONE","validationMessage":null},"8":{"slot":8,"fromId":202,"mapTo":"audit_copy_time","validationStatus":"NONE","validationMessage":null}},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FakeQuery2GetSourceSchema"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Database Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Connection URL","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jdbc:jtds:sqlserver://10.251.254.11/Beanstalk_Prod"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Usename","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_ETL"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Password","editorHint":"PASSWORD","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"Matillion_ETL"}}}},"visible":true,"status":{}},"8":{"slot":8,"name":"SQL Query","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select * , ${etl_audit_id} as audit_id, cast(getdate() as datetime) as stage_date\nfrom ${table_name} with (nolock) \nwhere 1=2"}}}},"visible":true,"status":{}},"9":{"slot":9,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"10":{"slot":10,"name":"S3 Staging Area","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"com.hc.dev.analytics"}}}},"visible":true,"status":{}},"11":{"slot":11,"name":"Connection Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"12":{"slot":12,"name":"Concurrency","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true,"status":{}},"13":{"slot":13,"name":"Distribution Style","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true,"status":{}},"14":{"slot":14,"name":"Distribution Key","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"15":{"slot":15,"name":"Sort Key","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{}},"16":{"slot":16,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${landing_schema}"}}}},"visible":true,"status":{}},"17":{"slot":17,"name":"Sort Key Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false,"status":{}},"96":{"slot":96,"name":"Location","editorHint":"S3_URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false,"status":{}},"97":{"slot":97,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"98":{"slot":98,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"99":{"slot":99,"name":"Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true,"status":{}},"1001":{"slot":1001,"name":"HIDDEN","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"1034":{"slot":1034,"name":"Load Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"40000":{"slot":40000,"name":"Encryption","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"40001":{"slot":40001,"name":"KMS Key ID","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191115":{"id":191115,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-516,"y":-282,"width":32,"height":32,"inputConnectorIDs":[191119],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Landing Table Created"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'landing table created'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191186":{"id":191186,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-804,"y":182,"width":32,"height":32,"inputConnectorIDs":[191196],"outputSuccessConnectorIDs":[191209],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gen Datamart Schema"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \nddl=''\naudit_columns=',etl_status smallint ,stage_id integer identity(1,1)'\nddl_delimiter=') DISTSTYLE'\n \nexec_sql =  ''' select replace(ddl, '\"${staging_schema}\".' ,'\"${datamart_schema}\".' )\n\tfrom admin.v_generate_tbl_ddl  \n\twhere schemaname= '${staging_schema}'  and tablename='${table_name}' '''\n   \nprint exec_sql\n\nlanding_cursor.execute(exec_sql )\nresults = landing_cursor.fetchall()\nprint results\nfor row in results:\n  #print ddl\n  ddl = ddl + ' ' + row[0] \n  \n##ddl = ddl.replace(ddl_delimiter, audit_columns + ddl_delimiter)  \nprint 'ddl: ' , ddl\ncontext.updateVariable('schema_clone',  ddl )"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191200":{"id":191200,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-642,"y":176,"width":32,"height":32,"inputConnectorIDs":[191209],"outputSuccessConnectorIDs":[191211],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create table in Datamart Schema"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${schema_clone};\n\n\n\n"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191374":{"id":191374,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1088,"y":-74,"width":32,"height":32,"inputConnectorIDs":[191417],"outputSuccessConnectorIDs":[191387],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of bashDebug1"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\necho \"schema_clone\" $schema_clone\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"191410":{"id":191410,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-909,"y":-67,"width":32,"height":32,"inputConnectorIDs":[191415],"outputSuccessConnectorIDs":[191417],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Staging Stat Debugger"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = '${schema_clone}' \nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"191040":{"id":191040,"sourceID":191034,"targetID":191037},"191211":{"id":191211,"sourceID":191200,"targetID":179913},"179945":{"id":179945,"sourceID":179896,"targetID":179897},"191209":{"id":191209,"sourceID":191186,"targetID":191200},"190511":{"id":190511,"sourceID":179904,"targetID":179905},"191119":{"id":191119,"sourceID":191089,"targetID":191115},"179948":{"id":179948,"sourceID":179902,"targetID":179910},"191056":{"id":191056,"sourceID":179897,"targetID":191034},"191504":{"id":191504,"sourceID":179906,"targetID":179902},"180247":{"id":180247,"sourceID":179913,"targetID":180242},"191415":{"id":191415,"sourceID":179909,"targetID":191410},"180181":{"id":180181,"sourceID":179922,"targetID":179903},"179930":{"id":179930,"sourceID":179910,"targetID":179921},"180090":{"id":180090,"sourceID":179893,"targetID":179896},"191387":{"id":191387,"sourceID":191374,"targetID":179906},"179928":{"id":179928,"sourceID":179907,"targetID":179908},"191417":{"id":191417,"sourceID":191410,"targetID":191374},"179933":{"id":179933,"sourceID":179921,"targetID":179911}},"failureConnectors":{},"unconditionalConnectors":{"179958":{"id":179958,"sourceID":179891,"targetID":179893}},"trueConnectors":{"179955":{"id":179955,"sourceID":179911,"targetID":179922},"179953":{"id":179953,"sourceID":179908,"targetID":179904},"191071":{"id":191071,"sourceID":191037,"targetID":179907}},"falseConnectors":{"180119":{"id":180119,"sourceID":179905,"targetID":180117},"179956":{"id":179956,"sourceID":179908,"targetID":179909},"191092":{"id":191092,"sourceID":191037,"targetID":191089},"191196":{"id":191196,"sourceID":179911,"targetID":191186}},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1503943035976,"canRedo":false,"redoCommand":"","redoCreated":1503656054814,"notes":{"179889":{"id":179889,"x":-549,"y":-84,"width":250,"height":58,"text":"if schema has changed ,end flow for this job,\nTODO: make sure to log this and/or send warning"}}},{"id":180059,"revision":34,"created":1506551166924,"timestamp":1506551166924,"components":{"180061":{"id":180061,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-2052,"y":-176,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[210266],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"210258":{"id":210258,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1227580116,"x":-1831,"y":-169,"width":32,"height":16,"inputConnectorIDs":[210266],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Job Iterator"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_jobs_to_run"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_id"},"2":{"slot":2,"type":"STRING","value":"etl_job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"table_name"},"2":{"slot":2,"type":"STRING","value":"table_name"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_column"},"2":{"slot":2,"type":"STRING","value":"max_create_column"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_column"},"2":{"slot":2,"type":"STRING","value":"max_update_column"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"max_date_columns"},"2":{"slot":2,"type":"STRING","value":"get_max_dates_sql"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"match_keys"},"2":{"slot":2,"type":"STRING","value":"match_keys"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"matched"},"2":{"slot":2,"type":"STRING","value":"matched_keys"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"matched_is_null"},"2":{"slot":2,"type":"STRING","value":"matched_is_null"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Ordering","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{}},"5":{"slot":5,"name":"Break on Failure","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Concurrency","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[210260],"inputIterationConnectorIDs":[]},"210259":{"id":210259,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1749,"y":-178,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Orchestration Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader From Staging"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[210260]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"210266":{"id":210266,"sourceID":180061,"targetID":210258}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"210260":{"id":210260,"sourceID":210258,"targetID":210259}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1506467299361,"canRedo":false,"redoCommand":"","redoCreated":1504814778762,"notes":{}},{"id":232419,"revision":597,"created":1514767274867,"timestamp":1514767274867,"components":{"232422":{"id":232422,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1703,"y":-224,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[232475],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232423":{"id":232423,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-829,"y":-223,"width":32,"height":32,"inputConnectorIDs":[232459],"outputSuccessConnectorIDs":[336851],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 2"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 2 ******************\"\n\necho \"audit_id: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates: \" $get_max_dates_sql"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232424":{"id":232424,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1598,"y":-221,"width":32,"height":32,"inputConnectorIDs":[232475],"outputSuccessConnectorIDs":[317242],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 1"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 1 ******************\"\necho \"now processing table_name: \" $table_name \necho \"job_id: \" $etl_job_id\necho \"get_max_dates: \" $get_max_dates_sql\n\n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232425":{"id":232425,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-724,"y":-286,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":-6,"mapTo":"audit_rowcount","validationStatus":"NONE","validationMessage":null},"2":{"slot":2,"fromId":-5,"mapTo":"audit_duration","validationStatus":"NONE","validationMessage":null},"3":{"slot":3,"fromId":-4,"mapTo":"audit_completed","validationStatus":"NONE","validationMessage":null},"4":{"slot":4,"fromId":-3,"mapTo":"audit_started","validationStatus":"NONE","validationMessage":null},"5":{"slot":5,"fromId":-2,"mapTo":"audit_status","validationStatus":"NONE","validationMessage":null},"6":{"slot":6,"fromId":-1,"mapTo":"audit_component","validationStatus":"NONE","validationMessage":null},"7":{"slot":7,"fromId":201,"mapTo":"audit_upload_time","validationStatus":"NONE","validationMessage":null},"8":{"slot":8,"fromId":202,"mapTo":"audit_copy_time","validationStatus":"NONE","validationMessage":null}},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pull&Load Source Data"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Database Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Connection URL","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jdbc:jtds:sqlserver://${source_server}/${source_db}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"6":{"slot":6,"name":"Usename","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_ETL"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"7":{"slot":7,"name":"Password","editorHint":"PASSWORD","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"Matillion_ETL"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"8":{"slot":8,"name":"SQL Query","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${crm_customer_id_plumb} * , ${etl_audit_id} as audit_id, cast(getdate() as datetime) as stage_date\nfrom ${table_name} with (nolock) \n${etl_where_logic}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"9":{"slot":9,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"10":{"slot":10,"name":"S3 Staging Area","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"com.hlc.etltest"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"11":{"slot":11,"name":"Connection Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"12":{"slot":12,"name":"Concurrency","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"13":{"slot":13,"name":"Distribution Style","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"14":{"slot":14,"name":"Distribution Key","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Parameter cannot be empty"}}},"15":{"slot":15,"name":"Sort Key","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"16":{"slot":16,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${landing_schema}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"17":{"slot":17,"name":"Sort Key Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"96":{"slot":96,"name":"Location","editorHint":"S3_URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false,"status":{}},"97":{"slot":97,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Input required."}}},"98":{"slot":98,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"A value is required."}}},"99":{"slot":99,"name":"Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"1001":{"slot":1001,"name":"HIDDEN","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"1034":{"slot":1034,"name":"Load Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"40000":{"slot":40000,"name":"Encryption","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"40001":{"slot":40001,"name":"KMS Key ID","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Parameter cannot be empty"}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[336853]},"232426":{"id":232426,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1464,"y":-173,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Updater Landed"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Updater"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"No input provided"}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[322230]},"232427":{"id":232427,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1048,"y":-221,"width":32,"height":32,"inputConnectorIDs":[232468],"outputSuccessConnectorIDs":[232455],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"No input provided"}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232428":{"id":232428,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-937,"y":-228,"width":32,"height":32,"inputConnectorIDs":[232455],"outputSuccessConnectorIDs":[232459],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GetAuditId"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute(''' select coalesce(max(etl_audit_id),-1) from admin.etl_audit where job_id = '${etl_job_id}' ''' )\n\nresult = cursor.fetchone()[0]\nprint 'Get AuditId: new Id: ', result \n\ncontext.updateVariable('etl_audit_id',  result )\n"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232430":{"id":232430,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1248,"y":54,"width":32,"height":32,"inputConnectorIDs":[310652],"outputSuccessConnectorIDs":[232460],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append Landing data to Staging"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${insert_sql}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"insert into staging.orders ( \"crm_customer_id\", \"order_id\", \"pos_order_no\", \"subtotal\", \"terminal_id\", \"loyalty_points_adj\", \"tax\", \"order_discounts_total\", \"line_discounts_total\", \"order_total\", \"customer_id\", \"pos_register_no\", \"loyalty_points_total\", \"pos_order_date\", \"loyalty_txn_id\", \"tax_exempt_id\", \"is_tax_exempt\", \"change_due\", \"last_update_ts\", \"date_created\", \"date_modified\", \"employee_id\", \"audit_id\", \"stage_date\")   select \"crm_customer_id\" , \"order_id\" , \"pos_order_no\" , \"subtotal\" , \"terminal_id\" , \"loyalty_points_adj\" , \"tax\" , \"order_discounts_total\" , \"line_discounts_total\" , \"order_total\" , \"customer_id\" , \"pos_register_no\" , \"loyalty_points_total\" , \"pos_order_date\" , \"loyalty_txn_id\" , \"tax_exempt_id\" , \"is_tax_exempt\" , \"change_due\" , \"last_update_ts\" , \"date_created\" , \"date_modified\" , \"employee_id\" , \"audit_id\" , \"stage_date\"  from landing.orders ","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232431":{"id":232431,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1376,"y":124,"width":32,"height":32,"inputConnectorIDs":[239403],"outputSuccessConnectorIDs":[278083],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Staged data to Prod"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into datamart.${table_name}\n( ${table_columns}, eff_date_start, eff_date_end, is_active )\n\nselect distinct ${table_columns_prefixed}, getdate(), '9999-01-01'::timestamp, 1\n from  staging.${table_name} s left join datamart.${table_name} d \non ${matched_keys}\nwhere  ${matched_is_null} s.audit_id = ${etl_audit_id} and s.etl_status is null;\n\n--************************** Update Control columns on Staging \"source\" table\n--the FROM clause does not support outer joins to the target table \n-- mark the rows just inserted as I \n update staging.${table_name}\n\tset etl_status='I'\nfrom  staging.${table_name} s inner join datamart.${table_name} d \non ${matched_keys}\nwhere s.audit_id =d.audit_id and s.etl_status is null ;"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"insert into datamart.orders\n( \"crm_customer_id\", \"order_id\", \"pos_order_no\", \"subtotal\", \"terminal_id\", \"loyalty_points_adj\", \"tax\", \"order_discounts_total\", \"line_discounts_total\", \"order_total\", \"customer_id\", \"pos_register_no\", \"loyalty_points_total\", \"pos_order_date\", \"loyalty_txn_id\", \"tax_exempt_id\", \"is_tax_exempt\", \"change_due\", \"last_update_ts\", \"date_created\", \"date_modified\", \"employee_id\", \"audit_id\" , eff_date_start, eff_date_end, is_active )\n\nselect distinct s.\"crm_customer_id\", s.\"order_id\", s.\"pos_order_no\", s.\"subtotal\", s.\"terminal_id\", s.\"loyalty_points_adj\", s.\"tax\", s.\"order_discounts_total\", s.\"line_discounts_total\", s.\"order_total\", s.\"customer_id\", s.\"pos_register_no\", s.\"loyalty_points_total\", s.\"pos_order_date\", s.\"loyalty_txn_id\", s.\"tax_exempt_id\", s.\"is_tax_exempt\", s.\"change_due\", s.\"last_update_ts\", s.\"date_created\", s.\"date_modified\", s.\"employee_id\", s.\"audit_id\" , getdate(), '9999-01-01'::timestamp, 1\n from  staging.orders s left join datamart.orders d \non s.crm_customer_id=d.crm_customer_id and s.order_id=d.order_id\nwhere  d.crm_customer_id is null  and d.order_id is null  and  s.audit_id = 2760 and s.etl_status is null;\n\n--************************** Update Control columns on Staging \"source\" table\n--the FROM clause does not support outer joins to the target table \n-- mark the rows just inserted as I \n update staging.orders\n\tset etl_status='I'\nfrom  staging.orders s inner join datamart.orders d \non s.crm_customer_id=d.crm_customer_id and s.order_id=d.order_id\nwhere s.audit_id =d.audit_id and s.etl_status is null ;","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232432":{"id":232432,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1092,"y":53,"width":32,"height":32,"inputConnectorIDs":[232460],"outputSuccessConnectorIDs":[232457],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit: Data is Staged"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n data staged: success'\nwhere etl_audit_id = ${etl_audit_id} "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n data staged: success'\nwhere etl_audit_id = 2760 ","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232433":{"id":232433,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-709,"y":205,"width":32,"height":32,"inputConnectorIDs":[318521],"outputSuccessConnectorIDs":[278126],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Update final"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n ETL: complete',\n     etl_end=getdate()\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n ETL: complete',\n     etl_end=getdate()\nwhere etl_audit_id = 2637","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232434":{"id":232434,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1001,"y":-105,"width":32,"height":32,"inputConnectorIDs":[232471],"outputSuccessConnectorIDs":[304098],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Schema Column Checker"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## initialize \ncontext.updateVariable('schema_check',  1 )\n \nlanding_cursor = context.cursor()\n \nlanding_cursor.execute('''\nSELECT  cast(column_name as varchar(50)) as my_column\n\t--, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='landing' and table_name = '${table_name}' and column_name <> 'audit_id'\n  \n except \n \n SELECT  cast(column_name as varchar(50)) as my_column\n \t--, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='staging' and table_name = '${table_name}' ''' )\n \nschema_change_columns=\" \"\nresults = landing_cursor.fetchall()\nif not results:\n\tcontext.updateVariable('schema_check',  1 )\n  \tprint(\"No Source Schema Change detected\")\n\nelse: \n  \t\n\tprint(\"Source Schema Change/s Detected\")  \n\n\tfor row in results:\n\t\tprint ('New column'+ row[0] )\n\t\tschema_change_columns = schema_change_columns + ' ' +  row[0]  \n        \n\tcontext.updateVariable('schema_change_columns',  schema_change_columns )\n    \n\t##for row in results:\n\t##\tprint  row[0], row[1]\n\t##\tif ((row[0] == 'customer_id' or row[0] == 'destination_id') and '${table_name}' == 'orders'):\n\t##\t\tprint(\"Known Change: orders.\"+ row[0] )\n\t##\t\tcontext.updateVariable('schema_check',  1 )\n\t##\telse:\n\t##\t\tprint (row[0] +\", \"+ row[1])\n\t##\t\tschema_change_columns = schema_change_columns + ' ' +  row[0] +\", \"+ row[1]\t\n\t##\t\tcontext.updateVariable('schema_check',  -1 )\n               \n\t##context.updateVariable('schema_change_columns',  schema_change_columns )\n\nprint 'schema_check: ' + str(${schema_check})\n### HARD-CODE while schemas are really different ###\n##context.updateVariable('schema_check',  1 ) \n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232435":{"id":232435,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-1193,"y":-120,"width":32,"height":32,"inputConnectorIDs":[304098],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[322122],"outputFalseConnectorIDs":[232473],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does Source Schema Match Staging ?"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Input required."}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232436":{"id":232436,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-726,"y":-118,"width":32,"height":32,"inputConnectorIDs":[336852],"outputSuccessConnectorIDs":[304090],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Staging"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables \n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere table_schema='${staging_schema}' and \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name=lower('${table_name}') )\n\t\t\tthen 1::smallint else 0::smallint end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232437":{"id":232437,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-878,"y":-112,"width":32,"height":32,"inputConnectorIDs":[304090],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[232471],"outputFalseConnectorIDs":[232472],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does it Exist?"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_exists"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Input required."}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232438":{"id":232438,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-937,"y":48,"width":32,"height":32,"inputConnectorIDs":[232457],"outputSuccessConnectorIDs":[232456],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Datamart"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${datamart_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name=lower('${table_name}') )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232439":{"id":232439,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-942,"y":130,"width":32,"height":32,"inputConnectorIDs":[232456],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[232469],"outputFalseConnectorIDs":[232474],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does Target Exist?"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Input required."}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232440":{"id":232440,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1108,"y":212,"width":32,"height":32,"inputConnectorIDs":[278093],"outputSuccessConnectorIDs":[247058],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 4"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 4 ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232442":{"id":232442,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-877,"y":-34,"width":32,"height":32,"inputConnectorIDs":[232472],"outputSuccessConnectorIDs":[298625],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Staging Table Missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\nStaging table missing'\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232443":{"id":232443,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-799,"y":127,"width":32,"height":32,"inputConnectorIDs":[232474],"outputSuccessConnectorIDs":[298634],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit: DM Table Missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'datamart table missing'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232444":{"id":232444,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1202,"y":-32,"width":32,"height":32,"inputConnectorIDs":[232473],"outputSuccessConnectorIDs":[298606],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit: Schema Change"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = status + '\\r\\n Schema Diff encountered: ${schema_change_columns} '\nwhere etl_audit_id =  ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232445":{"id":232445,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1094,"y":128,"width":32,"height":32,"inputConnectorIDs":[232469],"outputSuccessConnectorIDs":[239401],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Staging Columns for Prod"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"columns = '${table_columns}'.replace(', \"stage_date\"',' ').replace('\"stage_date\",',' ')\n#print 'table_columns : ' + columns\ncontext.updateVariable('table_columns',  columns )\n\n## $table_columns_prefixed will be used for the dynamic UPSERT logic\n\ncolumns = '${table_columns_prefixed}'.replace(', s.\"stage_date\"',' ').replace('s.\"stage_date\",',' ')\n#print 'table_columns_prefixed : ' + columns\ncontext.updateVariable('table_columns_prefixed',  columns )"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232446":{"id":232446,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1371,"y":203,"width":32,"height":32,"inputConnectorIDs":[239410],"outputSuccessConnectorIDs":[278090],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add Stage Updates to Prod"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--UPDATE (mark same natural pk rows as expired)\nupdate datamart.${table_name}  \n\tset is_active=0, eff_date_end=getdate()\nfrom staging.${table_name} s inner join datamart.${table_name} d \non ${matched_keys}\nwhere s.audit_id = ${etl_audit_id} and s.etl_status is null;\n\n-- INSERT the same natural pk rows as active \ninsert into datamart.${table_name}\n( ${table_columns}, eff_date_start, eff_date_end, is_active )\n\nselect distinct  ${table_columns_prefixed}, getdate(), '9999-01-01'::timestamp, 1\n from  staging.${table_name} s inner join datamart.${table_name} d\non ${matched_keys}\nwhere  s.audit_id = ${etl_audit_id} and s.etl_status is null;\n\n--************************** update Staging \"source\"\nupdate staging.${table_name}\n\tset etl_status='U'\nfrom  staging.${table_name} s inner join datamart.${table_name} d \non ${matched_keys}\nwhere s.audit_id = ${etl_audit_id}  and s.etl_status is null "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"--UPDATE (mark same natural pk rows as expired)\nupdate datamart.orders  \n\tset is_active=0, eff_date_end=getdate()\nfrom staging.orders s inner join datamart.orders d \non s.crm_customer_id=d.crm_customer_id and s.order_id=d.order_id\nwhere s.audit_id = 2760 and s.etl_status is null;\n\n-- INSERT the same natural pk rows as active \ninsert into datamart.orders\n( \"crm_customer_id\", \"order_id\", \"pos_order_no\", \"subtotal\", \"terminal_id\", \"loyalty_points_adj\", \"tax\", \"order_discounts_total\", \"line_discounts_total\", \"order_total\", \"customer_id\", \"pos_register_no\", \"loyalty_points_total\", \"pos_order_date\", \"loyalty_txn_id\", \"tax_exempt_id\", \"is_tax_exempt\", \"change_due\", \"last_update_ts\", \"date_created\", \"date_modified\", \"employee_id\", \"audit_id\" , eff_date_start, eff_date_end, is_active )\n\nselect distinct  s.\"crm_customer_id\", s.\"order_id\", s.\"pos_order_no\", s.\"subtotal\", s.\"terminal_id\", s.\"loyalty_points_adj\", s.\"tax\", s.\"order_discounts_total\", s.\"line_discounts_total\", s.\"order_total\", s.\"customer_id\", s.\"pos_register_no\", s.\"loyalty_points_total\", s.\"pos_order_date\", s.\"loyalty_txn_id\", s.\"tax_exempt_id\", s.\"is_tax_exempt\", s.\"change_due\", s.\"last_update_ts\", s.\"date_created\", s.\"date_modified\", s.\"employee_id\", s.\"audit_id\" , getdate(), '9999-01-01'::timestamp, 1\n from  staging.orders s inner join datamart.orders d\non s.crm_customer_id=d.crm_customer_id and s.order_id=d.order_id\nwhere  s.audit_id = 2760 and s.etl_status is null;\n\n--************************** update Staging \"source\"\nupdate staging.orders\n\tset etl_status='U'\nfrom  staging.orders s inner join datamart.orders d \non s.crm_customer_id=d.crm_customer_id and s.order_id=d.order_id\nwhere s.audit_id = 2760  and s.etl_status is null ","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232447":{"id":232447,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1145,"y":-221,"width":32,"height":32,"inputConnectorIDs":[246870],"outputSuccessConnectorIDs":[232468],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Cust_id Logic"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\n## customer_id=-1 --> ensures pulling all customers from crm tables\n\nif 'ble' in '${source_db}'.lower()  :\n    print  \"process customer_id \" + str(${crm_customer_id})  \n    context.updateVariable('crm_customer_id_plumb', str(${crm_customer_id}) + ' as crm_customer_id, ')\nelse:\n    ##print 'else'\n    context.updateVariable('crm_customer_id_plumb', ' ')\n \n \n## set fully_qualifed_table_name for component operations that require a schema.table_name reference \n##print 'fully_qualifed_table_name: ' + '${datamart_schema}'+'.'+'${table_name}'\ncontext.updateVariable('fully_qualifed_table_name', '${datamart_schema}'+'.'+'${table_name}')  \n  \n  \n\n\n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"232448":{"id":232448,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1412,"y":-224,"width":32,"height":32,"inputConnectorIDs":[317244],"outputSuccessConnectorIDs":[246867],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"set Upper Limit"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## SET Upper Limit\n\nimport datetime\nimport time\n\ncursor = context.cursor()\n\n##important change10/6/2017\n##cursor.execute('''select DATEADD(HOUR,-4, GETDATE())  as gdate''')\n## this was python formating required\n## ##print 'upper_datetime_boundary: ' + result[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\")  \n## GETDATE IGNORES the milliseconds\n\ncursor.execute('''select to_char(DATEADD(HOUR,-4, sysdate), 'YYYY-MM-DD HH24:MI:SS.MS') as gdate''')\n\nresult = cursor.fetchone()\nprint 'upper_datetime_boundary: ' + result[0] \n   \ncontext.updateVariable('upper_datetime_boundary', result[0] )\n\ntime.sleep(5)   # delays for 5 seconds\n \n\nwc0 = ''\nwc1 = ''\nall_wc = ''\n\nif not '${max_create_column}' : \t\n\tpass\nelse:\n   wc0 =    '${max_create_column}'  + ' < ' + '\\'' + result[0]   + '\\''\n\nif not '${max_update_column}' : \t\n\tpass\nelse:\n  \twc1 =  '${max_update_column}'  + ' < ' + '\\'' + result[0]  + '\\''  \n    \nif wc0 == '' and wc1 == '':\n\tall_wc = '(1=1)'\nelif wc0 == '':\n\tall_wc = '  (' + wc1 + ')'\nelif wc1 == '':\n\tall_wc =  '  (' + wc0 + ')'\nelse:\n \tall_wc =  ' ( ' + wc0 + ' and ' + wc1 +')'\n    \nprint 'all_wc' + all_wc  \nprint 'updated etl_where_logic: ' + etl_where_logic + ' and ' + all_wc \ncontext.updateVariable('etl_where_logic', etl_where_logic +' and '+ all_wc )\n  "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"239391":{"id":239391,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1240,"y":127,"width":32,"height":32,"inputConnectorIDs":[239401],"outputSuccessConnectorIDs":[239403],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug INSERTS"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"print \" \"\nprint \"insert into datamart.${table_name}\"\na = \"(  \" + ${table_columns} + \" , eff_date_start, eff_date_end, is_active )\"\n\nprint a\n\nb = \"select distinct \"  + '${table_columns_prefixed}' +\" , getdate(), '9999-01-01'::timestamp, 1\"\nprint b\nc = \" from  staging.\"+'${table_name}' +\" s left join datamart.${table_name} d \"\nprint c\nprint \"on ${matched_keys}\"\nprint \"where  ${matched_is_null} s.audit_id = ${etl_audit_id} and s.etl_status is null;\"\nprint \" \"\nprint \" update staging.${table_name}\"\nprint \"\tset etl_status='I'\"\nprint \"from  staging.${table_name} s inner join datamart.${table_name} d \"\nprint \"on ${matched_keys}\"\nprint \"where s.audit_id =d.audit_id and s.etl_status is null ;\""}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"239396":{"id":239396,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1502,"y":213,"width":32,"height":32,"inputConnectorIDs":[278085],"outputSuccessConnectorIDs":[239410],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug UPDATES"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"print \" \" \nprint \"update datamart.${table_name}  \"\nprint \"\tset is_active=0, eff_date_end=getdate()\"\nprint \"from staging.${table_name} s inner join datamart.${table_name} d \"\nprint \"on \" + '${matched_keys}' \nprint \"where s.audit_id = ${etl_audit_id} and s.etl_status is null;\"\n\nprint \" INSERT the same natural pk rows as active rows\"\nprint \"insert into datamart.${table_name}\"\nprint \"(\" + '${table_columns}' + \", eff_date_start, eff_date_end, is_active )\"\n\nprint \"select distinct \"+ '${table_columns_prefixed}' +\", getdate(), '9999-01-01'::timestamp, 1\"\nprint \" from  staging.${table_name} s inner join datamart.${table_name} d\"\nprint \"on ${matched_keys}\"\nprint \"where  s.audit_id = ${etl_audit_id} and s.etl_status is null;\"\n\nprint \" update Staging  source\"\nprint \"update staging.${table_name}\"\nprint \"\tset etl_status='U'\"\nprint \"from  staging.${table_name} s inner join datamart.${table_name} d \"\nprint \"on ${matched_keys}\"\nprint \"where s.audit_id = ${etl_audit_id}  and s.etl_status is null \""}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"246859":{"id":246859,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1286,"y":-226,"width":32,"height":32,"inputConnectorIDs":[246867],"outputSuccessConnectorIDs":[246870],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Once Off Retrieval Override"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## \n\n##audit_upload_timecoalesce(once_off_retrieval_logic_flag,0) once_off_retrieval_logic_flag\n\nretrieval_sql= '${once_off_retrieval_logic_sql}'\nretrieval_sql = retrieval_sql.strip()\nthis_list=\"\"\n\nif ${once_off_retrieval_logic_flag}:\n\tprint \"Once-Off Logic Enabled\"\n\tcursor = context.cursor()\n\tcursor.execute('''select contactId from landing.once_off_contacts''')\n\tresult = cursor.fetchall()\n\n\tfor row in result:\n\t\tthis_list += str(row[0]) + \", \"\n    \n\tthis_list = \"where contactId in (\" + this_list[:-2] + \")\"\n \n \tif this_list:\n\t\tprint \"ONCE OFF Retrieval Override SET\"\n\t\tprint this_list\n\t\tcontext.updateVariable('etl_where_logic', this_list )\n\telse:\n\t\tprint \"false\"\nelse:\n  \tprint \"Once-Off Logic Disabled\""}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"247052":{"id":247052,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-964,"y":211,"width":32,"height":32,"inputConnectorIDs":[247058],"outputSuccessConnectorIDs":[278120],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ETLJob OnceOff Reset"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_job\nset once_off_retrieval_logic_flag=0\nwhere job_id = ${etl_job_id}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"update admin.etl_job\nset once_off_retrieval_logic_flag=0\nwhere job_id = 70","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"252619":{"id":252619,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-837,"y":211,"width":32,"height":32,"inputConnectorIDs":[278120],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[318521],"outputFalseConnectorIDs":[304168],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Was Target Updated?"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"Input required."}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"276316":{"id":276316,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":-594,"y":214,"width":32,"height":32,"inputConnectorIDs":[278126],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"278075":{"id":278075,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1506,"y":123,"width":32,"height":32,"inputConnectorIDs":[278083],"outputSuccessConnectorIDs":[278085],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT dm insert"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n datamart: inserts'\nwhere etl_audit_id = ${etl_audit_id} "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n datamart: inserts'\nwhere etl_audit_id = 2760 ","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"278087":{"id":278087,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1231,"y":211,"width":32,"height":32,"inputConnectorIDs":[278090],"outputSuccessConnectorIDs":[278093],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT dm UPDATES"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n datamart: updates'\nwhere etl_audit_id = ${etl_audit_id} "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{"190679":{"environmentID":190679,"sql":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n datamart: updates'\nwhere etl_audit_id = 2760 ","showSql":false}},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"298604":{"id":298604,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-1033,"y":-37,"width":32,"height":32,"inputConnectorIDs":[298606],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Msg: Schema Change"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"AWS Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Topic Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dev-etl-crm"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Subject","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification for environment: ${environment}"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Message","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"It appears the source schema for table: ${table_name} is different from the Staging Schema.\nThis ETL job will not be run.\nPlease verify."}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"298623":{"id":298623,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-728,"y":-30,"width":32,"height":32,"inputConnectorIDs":[298625],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Msg : Staging missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"AWS Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Topic Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dev-etl-crm"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Subject","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification for environment: ${environment}"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Message","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"The Staging schema for table: ${table_name} is Missing.\nThis ETL job will not be run.\nPlease verify."}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"298632":{"id":298632,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-647,"y":126,"width":32,"height":32,"inputConnectorIDs":[298634],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Msg : Datamart missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"AWS Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Topic Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dev-etl-crm"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Subject","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification for environment: ${environment}"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Message","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"the Datamart schema for table: ${table_name} is Missing.\nThis ETL job will not be run.\nPlease verify."}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"304166":{"id":304166,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":-839,"y":304,"width":32,"height":32,"inputConnectorIDs":[304168],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Success No Update"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"310569":{"id":310569,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1493,"y":41,"width":32,"height":32,"inputConnectorIDs":[322229],"outputSuccessConnectorIDs":[310652],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gen Insert Metadata"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\n\ntablename='landing.${table_name}'\n#print tablename\n \n## check for any transformations \nsql =\"SELECT  attname::varchar column_name,  coalesce(t.transformation,'') trans, coalesce(t.column_name_as,'') col_alias  FROM pg_attribute p left join admin.etl_job_transform t on p.attname::varchar = t.column_name  WHERE  attrelid = '{}'::regclass AND  (attnum > 0) AND (NOT attisdropped)   and {} = coalesce(t.job_id,{})  order by attnum  \".format(tablename, ${etl_job_id}, ${etl_job_id} )  \n \n## for testing\n##sql=\" SELECT  attname::varchar column_name,  coalesce(t.transformation,'') transs, coalesce(t.column_name_as,'') col_alias FROM pg_attribute p left join admin.etl_job_transform t on p.attname::varchar = t.column_name  WHERE  attrelid = 'datamart.campaigns_ii'::regclass AND  (attnum > 0) AND (NOT attisdropped)   and 49=coalesce(49,0) order by attnum  \"\n  \n## delimit the column-names with \"column\" to cover for columns that are reserved words/ otherwise the insert will fail\njoin_columns = ''\nins_columns='' \nsel_columns=''\n\n#print sql\ncursor.execute(sql)\n##row[0] will always contain the column_name\n##row[1] contains the transformation, if exists\n##row[2] alias, if exists\n################################\nfor row in cursor:\n##check for the transformation\n\tif row[1]:\t\t\n  \t\tsel_columns += row[1] \n  \telse:\n\t\tsel_columns += '\"'+row[0]+'\"'  \n   \n##check for an alias\n\tif row[2]:\n\t\ttarget_column = row[2]\n\t\talias = row[2]\n\telse:\n\t\ttarget_column= row[0]\t\n\t\talias = ' '\n\n\tsel_columns += alias+', '\t\t\t\n\tins_columns += '\"'+target_column+'\"'  +', ' \n\tjoin_columns += 's.\"'+target_column+'\"'  +', '\n##################################################### \n    \n## strip -off the extra trailing  ', '    \nins_columns = ins_columns[:-2]\nsel_columns = sel_columns[:-2]\njoin_columns = join_columns[:-2]\n\ninsert_sql = 'insert into staging.${table_name} ( '+ ins_columns +')  ' +  ' select ' + sel_columns +' from landing.${table_name} '\nprint ''\nprint 'table_columns: ' + ins_columns \nprint ' '\nprint 'sel_columns: ' + sel_columns \nprint ' '\nprint 'table_columns_prefixed: ' + join_columns\nprint ' '\nprint 'insert_sql: ' + insert_sql\n \ncontext.updateVariable('insert_sql',  insert_sql )\ncontext.updateVariable('table_columns',  ins_columns )\ncontext.updateVariable('table_columns_prefixed',  join_columns )\n \n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314438":{"id":314438,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1505,"y":-228,"width":32,"height":32,"inputConnectorIDs":[317242],"outputSuccessConnectorIDs":[317244],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Lower Limit"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## SET Lower date boundary for retrieval\n\nlow_date_value\ncursor = context.cursor()\n## customer_id=-1 --> ensures pulling all customers from crm tables\n\ncursor.execute('''select to_char(max(max_create_date), 'YYYY-MM-DD HH24:MI:SS.MS') max_create_date, \n\t\t\t\t\t\t to_char(max(max_update_date), 'YYYY-MM-DD HH24:MI:SS.MS') max_update_date\n\t\t\t\t  from\n\t\t\t\t( \n\t\t\t\t\tselect coalesce(max_create_date, to_timestamp('${low_date_value}', 'YYYY-MM-DD')) max_create_date,  \n\t\t\t\t\t       coalesce(max_update_date, to_timestamp('${low_date_value}', 'YYYY-MM-DD')) max_update_date\t\n\t\t\t\t\tfrom admin.etl_audit \n\t\t\t\t\twhere etl_audit_id = ( \n                          \tselect max(etl_audit_id) from admin.etl_audit \n                            where coalesce(row_count,0) > 0 and job_id ='${etl_job_id}' and customer_id=${crm_customer_id}\n                          )\n\t\t\t\t\tunion \n\t\t\t\t\tselect \tto_timestamp('${low_date_value}', 'YYYY-MM-DD HH24:MI:SS.MS') max_create_date,  \n\t\t\t\t\t\t\tto_timestamp('${low_date_value}', 'YYYY-MM-DD HH24:MI:SS.MS') max_update_date\n\t\t\t\t) '''\n            )\t\n\nimport datetime \n\nresult = cursor.fetchone()\nprint result \n\nr0 =  result[0]\nr1 =  result[1]\n\nif not r0:\n  r0='${low_date_value}'\n  \nif not r1:\n  r1='${low_date_value}'\n  \n  \nwc0=''\nwc1=''\nall_wc=''\n\nif not '${max_create_column}' : \t\n\tpass\nelse:\n   \twc0 = '${max_create_column}' + ' > ' + '\\'' + r0 + '\\''\n    \nif not '${max_update_column}' : \t\n\tpass\nelse:\n   \twc1 = '${max_update_column}' + ' > ' + '\\'' + r1 + '\\''\n\n\nif wc0 == '' and wc1 == '':\n\tall_wc = ' where (1=1)  '\nelif wc0 == '':\n\tall_wc = ' where (' + wc1 +')'\nelif wc1 == '':\n\tall_wc =  ' where (' + wc0 +')'\nelse:\n \tall_wc =  ' where (' + wc0 + ' or ' + wc1+ ')'\n\n    \nprint 'wc0: ' + wc0\nprint 'wc1: ' + wc1\nprint 'etl_where_logic: ' + all_wc   \ncontext.updateVariable('etl_where_logic', all_wc)\n\n \n "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"322117":{"id":322117,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1358,"y":-109,"width":32,"height":32,"inputConnectorIDs":[322122],"outputSuccessConnectorIDs":[322228],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Updater Debug"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" *********** UPDATE DEBUG ******************\"\n\necho \"audit_id: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates: \" $get_max_dates_sql\necho \"table_name: \" $table_name\necho \"etl_job_id: \"${etl_job_id}\t\necho \"crm_customer_id: \"${crm_customer_id}\t\necho \"audit_status: \"${audit_status}\t\necho \"audaudit_startedit_id: \"${audit_started}\t\necho \"audit_completed: \"${audit_completed}\t\necho \"audit_rowcount: \"${audit_rowcount} \t\necho \"audit_upload_time: \"${audit_upload_time}\t\necho \"audit_copy_time: \"${audit_copy_time}\t\necho \" \"\n\n##echo \"select \"${etl_audit_id} \" as audit_id, \" ${get_max_dates_sql} \" from \"${landing_schema}\".\"${table_name} \" with (nolock)\""}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"322223":{"id":322223,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":-1486,"y":-119,"width":32,"height":16,"inputConnectorIDs":[322228],"outputSuccessConnectorIDs":[322229],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Number of Retries","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"2"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Retry Delay","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Short delay"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[322230],"inputIterationConnectorIDs":[]},"336848":{"id":336848,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":-718,"y":-224,"width":32,"height":16,"inputConnectorIDs":[336851],"outputSuccessConnectorIDs":[336852],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry Retrieval"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Number of Retries","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Retry Delay","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Long delay with backoff"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[336853],"inputIterationConnectorIDs":[]}},"successConnectors":{"278085":{"id":278085,"sourceID":278075,"targetID":239396},"232455":{"id":232455,"sourceID":232427,"targetID":232428},"298625":{"id":298625,"sourceID":232442,"targetID":298623},"278083":{"id":278083,"sourceID":232431,"targetID":278075},"232459":{"id":232459,"sourceID":232428,"targetID":232423},"278093":{"id":278093,"sourceID":278087,"targetID":232440},"232457":{"id":232457,"sourceID":232432,"targetID":232438},"232456":{"id":232456,"sourceID":232438,"targetID":232439},"278090":{"id":278090,"sourceID":232446,"targetID":278087},"298634":{"id":298634,"sourceID":232443,"targetID":298632},"232460":{"id":232460,"sourceID":232430,"targetID":232432},"246867":{"id":246867,"sourceID":232448,"targetID":246859},"247058":{"id":247058,"sourceID":232440,"targetID":247052},"336852":{"id":336852,"sourceID":336848,"targetID":232436},"246870":{"id":246870,"sourceID":246859,"targetID":232447},"336851":{"id":336851,"sourceID":232423,"targetID":336848},"232468":{"id":232468,"sourceID":232447,"targetID":232427},"304090":{"id":304090,"sourceID":232436,"targetID":232437},"304098":{"id":304098,"sourceID":232434,"targetID":232435},"239403":{"id":239403,"sourceID":239391,"targetID":232431},"239401":{"id":239401,"sourceID":232445,"targetID":239391},"278126":{"id":278126,"sourceID":232433,"targetID":276316},"298606":{"id":298606,"sourceID":232444,"targetID":298604},"278120":{"id":278120,"sourceID":247052,"targetID":252619},"322228":{"id":322228,"sourceID":322117,"targetID":322223},"239410":{"id":239410,"sourceID":239396,"targetID":232446},"322229":{"id":322229,"sourceID":322223,"targetID":310569},"310652":{"id":310652,"sourceID":310569,"targetID":232430},"317244":{"id":317244,"sourceID":314438,"targetID":232448},"317242":{"id":317242,"sourceID":232424,"targetID":314438}},"failureConnectors":{},"unconditionalConnectors":{"232475":{"id":232475,"sourceID":232422,"targetID":232424}},"trueConnectors":{"232471":{"id":232471,"sourceID":232437,"targetID":232434},"232469":{"id":232469,"sourceID":232439,"targetID":232445},"318521":{"id":318521,"sourceID":252619,"targetID":232433},"322122":{"id":322122,"sourceID":232435,"targetID":322117}},"falseConnectors":{"232474":{"id":232474,"sourceID":232439,"targetID":232443},"232473":{"id":232473,"sourceID":232435,"targetID":232444},"232472":{"id":232472,"sourceID":232437,"targetID":232442},"304168":{"id":304168,"sourceID":252619,"targetID":304166}},"iterationConnectors":{"336853":{"id":336853,"sourceID":336848,"targetID":232425},"322230":{"id":322230,"sourceID":322223,"targetID":232426}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1514767246710,"canRedo":false,"redoCommand":"","redoCreated":1512443182101,"notes":{"232420":{"id":232420,"x":-668,"y":-303,"width":250,"height":58,"text":"if schema has changed ,end flow for this job,\nTODO: make sure to log this and/or send warning"}}},{"id":285024,"revision":26,"created":1511736041058,"timestamp":1511736041058,"components":{"285025":{"id":285025,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1227580116,"x":-2224,"y":-94,"width":32,"height":16,"inputConnectorIDs":[285028],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job Iterator"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_crm_ble_jobs_to_run"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_id"},"2":{"slot":2,"type":"STRING","value":"etl_job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"crm_customer_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"table_name"},"2":{"slot":2,"type":"STRING","value":"table_name"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"},"2":{"slot":2,"type":"STRING","value":"job_order"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"source_db"},"2":{"slot":2,"type":"STRING","value":"source_db"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"source_server"},"2":{"slot":2,"type":"STRING","value":"source_server"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_column"},"2":{"slot":2,"type":"STRING","value":"max_create_column"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_column"},"2":{"slot":2,"type":"STRING","value":"max_update_column"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"max_date_columns"},"2":{"slot":2,"type":"STRING","value":"get_max_dates_sql"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"match_keys"},"2":{"slot":2,"type":"STRING","value":"match_keys"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"matched"},"2":{"slot":2,"type":"STRING","value":"matched_keys"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"matched_is_null"},"2":{"slot":2,"type":"STRING","value":"matched_is_null"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Ordering","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Break on Failure","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"7":{"slot":7,"name":"Concurrency","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[304023],"inputIterationConnectorIDs":[]},"285026":{"id":285026,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-2404,"y":-92,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[285028],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"285027":{"id":285027,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-2224,"y":-94,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Orchestration Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"INPUT_REQUIRED","validationMessage":"No input provided"}}}},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[304023]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"285028":{"id":285028,"sourceID":285026,"targetID":285025}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"304023":{"id":304023,"sourceID":285025,"targetID":285027}},"noteConnectors":{},"canUndo":true,"undoCommand":"Connect Iterator","undoCreated":1511736035066,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"285226":{"id":285226,"x":-2362,"y":-229,"width":200,"height":50,"text":"Main Driver\nDoes: Iterates through a list of ETL Jobs and their respective ETL Processing properties.\nEach Job's properties are mapped to a local set of env. variables to process.\nThe list of jobs is generated from the view:  admin.vw_jobs_to_run\nNotes:\n"}}},{"id":299583,"revision":6,"created":1512057435144,"timestamp":1512057435144,"components":{"299584":{"id":299584,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-337,"y":-63,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[299587],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"299585":{"id":299585,"inputCardinality":"ONE","outputCardinality":"ONE","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-537112080,"x":-178,"y":-99,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Vacuum Table"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Tables to Vacuum","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Vacuum Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FULL"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datamart"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[299588]},"299586":{"id":299586,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1227580116,"x":-170,"y":-68,"width":32,"height":16,"inputConnectorIDs":[299587],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job Iterator"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_crm_ble_jobs_to_vacuum"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_id"},"2":{"slot":2,"type":"STRING","value":"etl_job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"table_name"},"2":{"slot":2,"type":"STRING","value":"table_name"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Ordering","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Break on Failure","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Concurrency","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[299588],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"299587":{"id":299587,"sourceID":299584,"targetID":299586}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"299588":{"id":299588,"sourceID":299586,"targetID":299585}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1512057425944,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{}},{"id":179759,"revision":104,"created":1503395616858,"timestamp":1503395616858,"components":{"179761":{"id":179761,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1381,"y":-153,"width":32,"height":32,"inputConnectorIDs":[179815],"outputSuccessConnectorIDs":[179814],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Query Parameters"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute('''select coalesce(max_create_date, to_timestamp('1970-01-01', 'YYYY-MM-DD')) max_create_date,  \n\t\t\t\t\t coalesce(max_update_date, to_timestamp('1970-01-01', 'YYYY-MM-DD')) max_update_date\t\n\t\t\t\t\tfrom admin.etl_audit \n\t\t\t\t\twhere etl_audit_id = ( \n                          \tselect max(etl_audit_id) from admin.etl_audit where coalesce(row_count,0) > 0 and job_id ='${etl_job_id}'\n                          )'''\n            )\n\nimport datetime\n##import sys\n##print(sys.version) --> 2.7.1b3 (default:df42d5d6be04, Feb 3 2016, 03:22:46)\n\nresult = cursor.fetchone()\nprint result \n\nlow_date = '1970-01-01 00:00:00'\n\nif  result[0].strftime(\"%Y-%m-%d %H:%M:%S\" )  <> low_date:\n\twc0 = '${max_create_column}' + ' > ' + '\\'' + result[0].strftime(\"%Y-%m-%d %H:%M:%S\" ) + '\\''\nelse:\n\twc0=''\n\nif result[1].strftime(\"%Y-%m-%d %H:%M:%S\" ) <> low_date:\n\twc1 = '${max_update_column}' + ' > ' + '\\'' + result[1].strftime(\"%Y-%m-%d %H:%M:%S\" ) + '\\''\nelse:\n\twc1=''\n\nif wc0 == '' and wc1 == '':\n\tall_wc = ''\nelif wc0 == '':\n\tall_wc = ' where ' + wc1\nelif wc1 == '':\n\tall_wc =  ' where ' + wc0\nelse:\n \tall_wc =  ' where ' + wc0 + ' or ' + wc1\n\n    \nprint 'wc0: ' + wc0\nprint 'wc1: ' + wc1\nprint 'all: ' + all_wc   \n    \ncontext.updateVariable('max_create_date',  result[0].strftime(\"%Y-%m-%d %H:%M:%S\") ) \ncontext.updateVariable('max_update_date',  result[1].strftime(\"%Y-%m-%d %H:%M:%S\") ) \n \n\n\n\ncontext.updateVariable('etl_where_logic', all_wc)\n \n\n#print 'select_from_source_sql: ${select_from_source_sql}'                      \n\n####context.updateVariable('max_create_date',  '2018-01-01') \n##context.updateVariable('max_create_date',  result) --java.text.ParseException: java.text.ParseException: Variable [max_create_date] of type [DATETIME] failed to parse value [2017-06-18 20:12:18.033].\n\n## DateCreated > '${max_create_date}'\n##x=  '${etl_where_logic} '\n##print 'etl_where_logic: ' + x\n##context.updateVariable('select_from_source_sql',  'select \\*  ${table_name}' + ' where datecreated > ' +  result.strftime(\"%Y-%m-%d %H:%M:%S\")  )\n\n##print '$etl_where_logic' \n## print   result[:19]  --'datetime' object is unsubscriptable in <script> at line number 26\n#print   result.strftime(\"%Y-%m-%d %H:%M:%SZ\")\n## 2017-06-18 20:12:18 \n \n## select_from_source_sql = 'select \\* from ' + ${table_name} + ' where ' + ${etl_where_logic}\n\n##  context.updateVariable('select_from_source_sql', 'new-value')"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179762":{"id":179762,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1543,"y":-156,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[179832],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179763":{"id":179763,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1078,"y":-229,"width":32,"height":32,"inputConnectorIDs":[179816],"outputSuccessConnectorIDs":[179813],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"bashDebug I"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  DEBUG I ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179764":{"id":179764,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1460,"y":-225,"width":32,"height":32,"inputConnectorIDs":[179832],"outputSuccessConnectorIDs":[179815],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"bashDebug1"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\necho $audit_completed\necho \"in table: \" $table_name\n#echo \"in job_id \" $etl_job_id\n#echo \"in max_create\" $max_create_date\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179765":{"id":179765,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-1080,"y":-97,"width":32,"height":32,"inputConnectorIDs":[179813],"outputSuccessConnectorIDs":[179801],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":-6,"mapTo":"audit_rowcount","validationStatus":"NONE","validationMessage":null},"2":{"slot":2,"fromId":-5,"mapTo":"audit_duration","validationStatus":"NONE","validationMessage":null},"3":{"slot":3,"fromId":-4,"mapTo":"audit_completed","validationStatus":"NONE","validationMessage":null},"4":{"slot":4,"fromId":-3,"mapTo":"audit_started","validationStatus":"NONE","validationMessage":null},"5":{"slot":5,"fromId":-2,"mapTo":"audit_status","validationStatus":"NONE","validationMessage":null},"6":{"slot":6,"fromId":-1,"mapTo":"audit_component","validationStatus":"NONE","validationMessage":null},"7":{"slot":7,"fromId":201,"mapTo":"audit_upload_time","validationStatus":"NONE","validationMessage":null},"8":{"slot":8,"fromId":202,"mapTo":"audit_copy_time","validationStatus":"NONE","validationMessage":null}},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pull &Load Incremental Data"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Database Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Connection URL","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jdbc:jtds:sqlserver://10.251.254.11/Beanstalk_Prod"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Usename","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_ETL"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Password","editorHint":"PASSWORD","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"Matillion_ETL"}}}},"visible":true,"status":{}},"8":{"slot":8,"name":"SQL Query","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select * , ${etl_audit_id} as audit_id, cast(getdate() as datetime) as stage_date\nfrom ${table_name} with (nolock) \n${etl_where_logic}"}}}},"visible":true,"status":{}},"9":{"slot":9,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"10":{"slot":10,"name":"S3 Staging Area","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"com.hc.dev.analytics"}}}},"visible":true,"status":{}},"11":{"slot":11,"name":"Connection Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"12":{"slot":12,"name":"Concurrency","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true,"status":{}},"13":{"slot":13,"name":"Distribution Style","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true,"status":{}},"14":{"slot":14,"name":"Distribution Key","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"15":{"slot":15,"name":"Sort Key","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{}},"16":{"slot":16,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${landing_schema}"}}}},"visible":true,"status":{}},"17":{"slot":17,"name":"Sort Key Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false,"status":{}},"96":{"slot":96,"name":"Location","editorHint":"S3_URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false,"status":{}},"97":{"slot":97,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"98":{"slot":98,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"99":{"slot":99,"name":"Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true,"status":{}},"1001":{"slot":1001,"name":"HIDDEN","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"1034":{"slot":1034,"name":"Load Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"40000":{"slot":40000,"name":"Encryption","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"40001":{"slot":40001,"name":"KMS Key ID","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179766":{"id":179766,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-934,"y":-102,"width":32,"height":32,"inputConnectorIDs":[179801],"outputSuccessConnectorIDs":[179825],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Updater Landed"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Updater"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179767":{"id":179767,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1268,"y":-158,"width":32,"height":32,"inputConnectorIDs":[179814],"outputSuccessConnectorIDs":[179817],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179768":{"id":179768,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1159,"y":-157,"width":32,"height":32,"inputConnectorIDs":[179817],"outputSuccessConnectorIDs":[179816],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GetAuditId"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute(''' select coalesce(max(etl_audit_id),-1) from admin.etl_audit where job_id = '${etl_job_id}' ''' )\n\n \n\nimport datetime\n##import sys\n##print(sys.version) --> 2.7.1b3 (default:df42d5d6be04, Feb 3 2016, 03:22:46)\n\nresult = cursor.fetchone()[0]\nprint 'new auditid: ', result \n\ncontext.updateVariable('etl_audit_id',  result )\ncontext.updateVariable('audit_id_backup',  result )"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179769":{"id":179769,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-717,"y":55,"width":32,"height":32,"inputConnectorIDs":[190497],"outputSuccessConnectorIDs":[179823],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gen Insert Metadata"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute(''' SELECT cast(column_name as varchar(50)) as my_column\n  FROM information_schema.columns\n WHERE table_schema='landing' and table_name = '${table_name}' ''' )\n\n## delimit the column-names with \"column\" to cover for columns that are reserved words/else the insert will fails\n\ncolumns='' \nfor row in cursor:\n\tcolumns = columns + '\"'+row[0]+'\"'  +', '\n    \n## strip -off the last ', '    \ncolumns = columns[:-2]\n\n##print 'columns: ' + columns \n\ninsert_sql = 'insert into staging.${table_name} ( '+ columns +') select ' + columns +' from landing.${table_name} '\n\n##print ' insert_sql: ' + insert_sql\ncontext.updateVariable('insert_sql',  insert_sql )\n\ncontext.updateVariable('table_columns',  columns )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179770":{"id":179770,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-903,"y":48,"width":32,"height":32,"inputConnectorIDs":[179823],"outputSuccessConnectorIDs":[190494],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append Landing data to Staging"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${insert_sql}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179771":{"id":179771,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-580,"y":256,"width":32,"height":32,"inputConnectorIDs":[179808],"outputSuccessConnectorIDs":[179798],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Finalize Staged data to Production"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into datamart_inc.${table_name}\n( ${table_columns} )\n\nselect ${table_columns}\nfrom staging.${table_name}\nwhere audit_id = ${etl_audit_id}       "}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179772":{"id":179772,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-808,"y":260,"width":32,"height":32,"inputConnectorIDs":[180019],"outputSuccessConnectorIDs":[179808],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Staging Columns for final Prod Insert"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\ncolumns = '${table_columns}'.replace('\"stage_date\",',' ')\nprint 'drop stage_date > columns: ' + columns\n\ncontext.updateVariable('table_columns',  columns )\n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179773":{"id":179773,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1204,"y":53,"width":32,"height":32,"inputConnectorIDs":[190494],"outputSuccessConnectorIDs":[179820],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Update Staged"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'staged'\nwhere etl_audit_id = '${audit_id_backup}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179774":{"id":179774,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-307,"y":255,"width":32,"height":32,"inputConnectorIDs":[179802],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Update final"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'complete'\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179775":{"id":179775,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-432,"y":-93,"width":32,"height":32,"inputConnectorIDs":[179827],"outputSuccessConnectorIDs":[190500],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Schema Column Checker"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute('''\nSELECT  cast(column_name as varchar(50)) as my_column, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='landing' and table_name = '${table_name}' and column_name <> 'audit_id'\n  \n except \n \n SELECT  cast(column_name as varchar(50)) as my_column, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='staging' and table_name = '${table_name}' ''' )\n\n\nresults = landing_cursor.fetchall()\nif not results:\n\tcontext.updateVariable('schema_check',  1 )\n  \t##print(\"No Source Schema Change detected\")\n\nelse: \n  \tcontext.updateVariable('schema_check',  -1 )\n\t##print(\"Source Schema Change/s Detected\")  \n\tfor row in results:\n\t\tschema_change_columns = schema_change_columns + ' ' +  row[0], row[1]\t\n    \n\t##print schema_change_columns\n\tcontext.updateVariable('schema_change_columns',  schema_change_columns )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179776":{"id":179776,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-437,"y":54,"width":32,"height":32,"inputConnectorIDs":[190500],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[190497],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Is Stage Schema Current with Source"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179778":{"id":179778,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-759,"y":-89,"width":32,"height":32,"inputConnectorIDs":[179824],"outputSuccessConnectorIDs":[179800],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Staging"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${landing_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name='${table_name}' )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179779":{"id":179779,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-635,"y":-93,"width":32,"height":32,"inputConnectorIDs":[179800],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[179827],"outputFalseConnectorIDs":[179968],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does it Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_exists"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179781":{"id":179781,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1194,"y":162,"width":32,"height":32,"inputConnectorIDs":[179820],"outputSuccessConnectorIDs":[190491],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Check for Table in Datamart"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${datamart_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name='${table_name}' )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179782":{"id":179782,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-980,"y":158,"width":32,"height":32,"inputConnectorIDs":[190491],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[179829],"outputFalseConnectorIDs":[190488],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Does it Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179785":{"id":179785,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-851,"y":-157,"width":32,"height":32,"inputConnectorIDs":[179825],"outputSuccessConnectorIDs":[179824],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug2"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  DEBUG II ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179791":{"id":179791,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-436,"y":261,"width":32,"height":32,"inputConnectorIDs":[179798],"outputSuccessConnectorIDs":[179802],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug Final"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug Final ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179793":{"id":179793,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-975,"y":248,"width":32,"height":32,"inputConnectorIDs":[179829],"outputSuccessConnectorIDs":[180019],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 7A"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 7A ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"179962":{"id":179962,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-638,"y":-17,"width":32,"height":32,"inputConnectorIDs":[179968],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Staging Table Missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'staging table missing'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"180007":{"id":180007,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-676,"y":156,"width":32,"height":32,"inputConnectorIDs":[190488],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Datamart Table Missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'datamart table missing'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"179808":{"id":179808,"sourceID":179772,"targetID":179771},"179814":{"id":179814,"sourceID":179761,"targetID":179767},"179815":{"id":179815,"sourceID":179764,"targetID":179761},"190500":{"id":190500,"sourceID":179775,"targetID":179776},"179813":{"id":179813,"sourceID":179763,"targetID":179765},"179816":{"id":179816,"sourceID":179768,"targetID":179763},"179817":{"id":179817,"sourceID":179767,"targetID":179768},"179823":{"id":179823,"sourceID":179769,"targetID":179770},"179820":{"id":179820,"sourceID":179773,"targetID":179781},"180019":{"id":180019,"sourceID":179793,"targetID":179772},"179824":{"id":179824,"sourceID":179785,"targetID":179778},"179825":{"id":179825,"sourceID":179766,"targetID":179785},"179798":{"id":179798,"sourceID":179771,"targetID":179791},"179802":{"id":179802,"sourceID":179791,"targetID":179774},"190491":{"id":190491,"sourceID":179781,"targetID":179782},"179800":{"id":179800,"sourceID":179778,"targetID":179779},"179801":{"id":179801,"sourceID":179765,"targetID":179766},"190494":{"id":190494,"sourceID":179770,"targetID":179773}},"failureConnectors":{},"unconditionalConnectors":{"179832":{"id":179832,"sourceID":179762,"targetID":179764}},"trueConnectors":{"179827":{"id":179827,"sourceID":179779,"targetID":179775},"190497":{"id":190497,"sourceID":179776,"targetID":179769},"179829":{"id":179829,"sourceID":179782,"targetID":179793}},"falseConnectors":{"179968":{"id":179968,"sourceID":179779,"targetID":179962},"190488":{"id":190488,"sourceID":179782,"targetID":180007}},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Rename Job","undoCreated":1503385249543,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"179760":{"id":179760,"x":-573,"y":-194,"width":250,"height":58,"text":"if schema has changed ,end flow for this job,\nTODO: make sure to log this and/or send warning"}}},{"id":308160,"revision":6,"created":1512864157225,"timestamp":1512864157225,"components":{"308161":{"id":308161,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-337,"y":-63,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[308164],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"308162":{"id":308162,"inputCardinality":"ONE","outputCardinality":"ONE","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-537112080,"x":-178,"y":-99,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Vacuum Table"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Tables to Vacuum","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Vacuum Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FULL"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datamart"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[308165]},"308163":{"id":308163,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1227580116,"x":-170,"y":-68,"width":32,"height":16,"inputConnectorIDs":[308164],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job Iterator"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_crm_bst_jobs_to_run"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_id"},"2":{"slot":2,"type":"STRING","value":"etl_job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"table_name"},"2":{"slot":2,"type":"STRING","value":"table_name"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Ordering","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Break on Failure","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Concurrency","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[308165],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"308164":{"id":308164,"sourceID":308161,"targetID":308163}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"308165":{"id":308165,"sourceID":308163,"targetID":308162}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1512057203208,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{}},{"id":311354,"revision":2,"created":1512245109684,"timestamp":1512245109684,"components":{},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{}},{"id":311725,"revision":2,"created":1512269594013,"timestamp":1512269594013,"components":{"311727":{"id":311727,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1227580116,"x":-2224,"y":-94,"width":32,"height":16,"inputConnectorIDs":[311730],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job Iterator"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"vw_crm_ble_jobs_to_run"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_id"},"2":{"slot":2,"type":"STRING","value":"etl_job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"crm_customer_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"table_name"},"2":{"slot":2,"type":"STRING","value":"table_name"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"},"2":{"slot":2,"type":"STRING","value":"job_order"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"source_db"},"2":{"slot":2,"type":"STRING","value":"source_db"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"source_server"},"2":{"slot":2,"type":"STRING","value":"source_server"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_column"},"2":{"slot":2,"type":"STRING","value":"max_create_column"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_column"},"2":{"slot":2,"type":"STRING","value":"max_update_column"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"max_date_columns"},"2":{"slot":2,"type":"STRING","value":"get_max_dates_sql"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"match_keys"},"2":{"slot":2,"type":"STRING","value":"match_keys"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"matched"},"2":{"slot":2,"type":"STRING","value":"matched_keys"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"matched_is_null"},"2":{"slot":2,"type":"STRING","value":"matched_is_null"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Ordering","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"job_order"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Break on Failure","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Concurrency","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[311731],"inputIterationConnectorIDs":[]},"311728":{"id":311728,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-2404,"y":-92,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[311730],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"311729":{"id":311729,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-2224,"y":-94,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Orchestration Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Incremental Loader"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[311731]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"311730":{"id":311730,"sourceID":311728,"targetID":311727}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"311731":{"id":311731,"sourceID":311727,"targetID":311729}},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"311726":{"id":311726,"x":-2362,"y":-229,"width":200,"height":50,"text":"Main Driver\nDoes: Iterates through a list of ETL Jobs and their respective ETL Processing properties.\nEach Job's properties are mapped to a local set of env. variables to process.\nThe list of jobs is generated from the view:  admin.vw_jobs_to_run\nNotes:\n"}}},{"id":314462,"revision":3,"created":1512443268740,"timestamp":1512443268740,"components":{"314464":{"id":314464,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1609,"y":-104,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Lower Limit"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## SET Lower date boundary for retrieval\n\nimport datetime \ncursor = context.cursor()\n\ndef High_Value_Date():\n\tsql='''select to_char(max(max_create_date), 'YYYY-MM-DD HH24:MI:SS.MS') max_create_date, \n\t\t\t\t\t\t to_char(max(max_update_date), 'YYYY-MM-DD HH24:MI:SS.MS') max_update_date\n\t\t\t\t  from\n\t\t\t\t( \n\t\t\t\t\tselect coalesce(max_create_date, to_timestamp('${low_date_value}', 'YYYY-MM-DD')) max_create_date,  \n\t\t\t\t\t       coalesce(max_update_date, to_timestamp('${low_date_value}', 'YYYY-MM-DD')) max_update_date\t\n\t\t\t\t\tfrom admin.etl_audit \n\t\t\t\t\twhere etl_audit_id = ( \n                          \tselect max(etl_audit_id) from admin.etl_audit \n                            where coalesce(row_count,0) > 0 and job_id ='${etl_job_id}' and customer_id=${crm_customer_id}\n                          )\n\t\t\t\t\tunion \n\t\t\t\t\tselect \tto_timestamp('${low_date_value}', 'YYYY-MM-DD') max_create_date,  \n\t\t\t\t\t\t\tto_timestamp('${low_date_value}', 'YYYY-MM-DD') max_update_date\n\t\t\t\t)  '''\n\treturn sql    \n    \ndef High_Value_Numeric():\n\tsql='''select   max(max_create_date)  max_create_date, '1900-01-01' max_update_date\n\t\t\t\t  from\n\t\t\t\t( \n\t\t\t\t\tselect coalesce(max_create_date,   '${low_date_value}'  ) max_create_date  \n\t\t\t\t\tfrom admin.etl_audit \n\t\t\t\t\twhere etl_audit_id = ( \n                          \tselect max(etl_audit_id) from admin.etl_audit \n                            where coalesce(row_count,0) > 0 and job_id ='${etl_job_id}' and customer_id=${crm_customer_id}\n                          )\n\t\t\t\t\tunion \n\t\t\t\t\tselect  '${low_date_value}'  max_create_date \n\t\t\t\t\t\t\t \n\t\t\t\t) '''\n\treturn sql\n\n  \n##force to use date-only  \nsql=High_Value_Date()\n## determine type of high-water mark (max(id) or max(create_date))\n##cursor.execute('''SELECT data_type from admin.vw_schema_columns WHERE  table_name = '${table_name}'  and  column_name  =coalesce('${max_create_column}','${max_update_column}') ''') \n               \n##result = cursor.fetchone()\n##if result:\n##\tr0 = result[0]\n\n##\tif r0=='date':\n##\t\tsql=High_Value_Date()\n##\telse:\n##\t\tsql=High_Value_Numeric()  \n                             \n## customer_id=-1 --> ensures pulling all customers from crm tables\nprint sql\n\n\ncursor.execute(sql)\nresult = cursor.fetchone()\n##print result \n\nr0 =  result[0]\nr1 =  result[1]\n\nif not r0:\n  r0='${low_date_value}'\n  \nif not r1:\n  r1='${low_date_value}'\n  \n  \nwc0=''\nwc1=''\nall_wc=''\n\nif not '${max_create_column}' : \t\n\tpass\nelse:\n\twc0 = '${max_create_column}' + ' > ' + '\\'' + str(r0) + '\\''\n    \nif not '${max_update_column}' : \t\n\tpass\nelse:\n   \twc1 = '${max_update_column}' + ' > ' + '\\'' + str(r1) + '\\''\n\n\nif wc0 == '' and wc1 == '':\n\tall_wc = ' where (1=1)  '\nelif wc0 == '':\n\tall_wc = ' where (' + wc1 +')'\nelif wc1 == '':\n\tall_wc =  ' where (' + wc0 +')'\nelse:\n \tall_wc =  ' where (' + wc0 + ' or ' + wc1+ ')'\n\n    \nprint 'wc0: ' + wc0\nprint 'wc1: ' + wc1\nprint 'etl_where_logic: ' + all_wc   \ncontext.updateVariable('etl_where_logic', all_wc)\n\n \n#####################################################################################\n#####################################################################################\n\n##if  result[0].strftime(\"%Y-%m-%d %H:%M:%S\" ) <> '${low_date_value}':\n##\twc0 = '${max_create_column}' + ' > ' + '\\'' + result[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\")[:-3] + '\\''\n##else:\n##\twc0 = '${max_create_column}' + ' > ' + '\\'' + '${low_date_value}' + '\\''\n\n    \n    \n"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314465":{"id":314465,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1594,"y":-284,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[314545],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314466":{"id":314466,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-829,"y":-223,"width":32,"height":32,"inputConnectorIDs":[314512],"outputSuccessConnectorIDs":[314510],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 2"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 2 ******************\"\n\necho \"audit_id: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates: \" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314467":{"id":314467,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1598,"y":-221,"width":32,"height":32,"inputConnectorIDs":[314545],"outputSuccessConnectorIDs":[314524],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 1"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 1 ******************\"\necho \"now processing table_name: \" $table_name \necho \"job_id: \" $etl_job_id\necho \"get_max_dates: \" $get_max_dates_sql\n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314468":{"id":314468,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-721,"y":-225,"width":32,"height":32,"inputConnectorIDs":[314510],"outputSuccessConnectorIDs":[314523],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":-6,"mapTo":"audit_rowcount","validationStatus":"NONE","validationMessage":null},"2":{"slot":2,"fromId":-5,"mapTo":"audit_duration","validationStatus":"NONE","validationMessage":null},"3":{"slot":3,"fromId":-4,"mapTo":"audit_completed","validationStatus":"NONE","validationMessage":null},"4":{"slot":4,"fromId":-3,"mapTo":"audit_started","validationStatus":"NONE","validationMessage":null},"5":{"slot":5,"fromId":-2,"mapTo":"audit_status","validationStatus":"NONE","validationMessage":null},"6":{"slot":6,"fromId":-1,"mapTo":"audit_component","validationStatus":"NONE","validationMessage":null},"7":{"slot":7,"fromId":201,"mapTo":"audit_upload_time","validationStatus":"NONE","validationMessage":null},"8":{"slot":8,"fromId":202,"mapTo":"audit_copy_time","validationStatus":"NONE","validationMessage":null}},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pull&Load Source Data"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Database Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Connection URL","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jdbc:jtds:sqlserver://${source_server}/${source_db}"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Usename","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion_ETL"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Password","editorHint":"PASSWORD","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"Matillion_ETL"}}}},"visible":true,"status":{}},"8":{"slot":8,"name":"SQL Query","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${crm_customer_id_plumb} * , ${etl_audit_id} as audit_id, cast(getdate() as datetime) as stage_date\nfrom ${table_name} with (nolock) \n${etl_where_logic}"}}}},"visible":true,"status":{}},"9":{"slot":9,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"10":{"slot":10,"name":"S3 Staging Area","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"com.hlc.etltest"}}}},"visible":true,"status":{}},"11":{"slot":11,"name":"Connection Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"12":{"slot":12,"name":"Concurrency","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true,"status":{}},"13":{"slot":13,"name":"Distribution Style","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true,"status":{}},"14":{"slot":14,"name":"Distribution Key","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"15":{"slot":15,"name":"Sort Key","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{}},"16":{"slot":16,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${landing_schema}"}}}},"visible":true,"status":{}},"17":{"slot":17,"name":"Sort Key Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false,"status":{}},"96":{"slot":96,"name":"Location","editorHint":"S3_URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false,"status":{}},"97":{"slot":97,"name":"Target Table","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"98":{"slot":98,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"99":{"slot":99,"name":"Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true,"status":{}},"1001":{"slot":1001,"name":"HIDDEN","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"1034":{"slot":1034,"name":"Load Options","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"40000":{"slot":40000,"name":"Encryption","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"40001":{"slot":40001,"name":"KMS Key ID","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314469":{"id":314469,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1392,"y":-119,"width":32,"height":32,"inputConnectorIDs":[314540],"outputSuccessConnectorIDs":[314530],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Updater Landed"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Updater"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314470":{"id":314470,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1048,"y":-221,"width":32,"height":32,"inputConnectorIDs":[314522],"outputSuccessConnectorIDs":[314507],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Transformation Job","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AuditRecord INIT"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Overwrite Variables","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Set Variables","editorHint":"GENERIC_GRID","elements":{},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314471":{"id":314471,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-937,"y":-228,"width":32,"height":32,"inputConnectorIDs":[314507],"outputSuccessConnectorIDs":[314512],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GetAuditId"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\ncursor.execute(''' select coalesce(max(etl_audit_id),-1) from admin.etl_audit where job_id = '${etl_job_id}' ''' )\n\nresult = cursor.fetchone()[0]\nprint 'Get AuditId: new Id: ', result \n\ncontext.updateVariable('etl_audit_id',  result )\n"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314472":{"id":314472,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1248,"y":54,"width":32,"height":32,"inputConnectorIDs":[314536],"outputSuccessConnectorIDs":[314518],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append Landing data to Staging"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${insert_sql}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314473":{"id":314473,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1376,"y":124,"width":32,"height":32,"inputConnectorIDs":[314528],"outputSuccessConnectorIDs":[314511],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert Staged data to Prod"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into datamart.${table_name}\n( ${table_columns}, eff_date_start, eff_date_end, is_active )\n\nselect distinct ${table_columns_prefixed}, getdate(), '9999-01-01'::timestamp, 1\n from  staging.${table_name} s left join datamart.${table_name} d \non ${matched_keys}\nwhere  ${matched_is_null} s.audit_id = ${etl_audit_id} and s.etl_status is null;\n\n--************************** Update Control columns on Staging \"source\" table\n--the FROM clause does not support outer joins to the target table \n-- mark the rows just inserted as I \n update staging.${table_name}\n\tset etl_status='I'\nfrom  staging.${table_name} s inner join datamart.${table_name} d \non ${matched_keys}\nwhere s.audit_id =d.audit_id and s.etl_status is null ;"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314474":{"id":314474,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1092,"y":53,"width":32,"height":32,"inputConnectorIDs":[314518],"outputSuccessConnectorIDs":[314514],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit: Data is Staged"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n data staged: success'\nwhere etl_audit_id = ${etl_audit_id} "}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314475":{"id":314475,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-562,"y":309,"width":32,"height":32,"inputConnectorIDs":[314529],"outputSuccessConnectorIDs":[314532],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Update final"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n ETL: complete',\n     etl_end=getdate()\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314476":{"id":314476,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1001,"y":-105,"width":32,"height":32,"inputConnectorIDs":[314538],"outputSuccessConnectorIDs":[314527],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Schema Column Checker"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## initialize \ncontext.updateVariable('schema_check',  1 )\n \nlanding_cursor = context.cursor()\n \nlanding_cursor.execute('''\nSELECT  cast(column_name as varchar(50)) as my_column\n\t--, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='landing' and table_name = '${table_name}' and column_name <> 'audit_id'\n  \n except \n \n SELECT  cast(column_name as varchar(50)) as my_column\n \t--, data_type, character_maximum_length, numeric_precision, numeric_scale\n  FROM information_schema.columns\n WHERE table_schema='staging' and table_name = '${table_name}' ''' )\n \nschema_change_columns=\" \"\nresults = landing_cursor.fetchall()\nif not results:\n\tcontext.updateVariable('schema_check',  1 )\n  \tprint(\"No Source Schema Change detected\")\n\nelse: \n  \t\n\tprint(\"Source Schema Change/s Detected\")  \n\n\tfor row in results:\n\t\tprint ('New column'+ row[0] )\n\t\tschema_change_columns = schema_change_columns + ' ' +  row[0]  \n        \n\tcontext.updateVariable('schema_change_columns',  schema_change_columns )\n    \n\t##for row in results:\n\t##\tprint  row[0], row[1]\n\t##\tif ((row[0] == 'customer_id' or row[0] == 'destination_id') and '${table_name}' == 'orders'):\n\t##\t\tprint(\"Known Change: orders.\"+ row[0] )\n\t##\t\tcontext.updateVariable('schema_check',  1 )\n\t##\telse:\n\t##\t\tprint (row[0] +\", \"+ row[1])\n\t##\t\tschema_change_columns = schema_change_columns + ' ' +  row[0] +\", \"+ row[1]\t\n\t##\t\tcontext.updateVariable('schema_check',  -1 )\n               \n\t##context.updateVariable('schema_change_columns',  schema_change_columns )\n\nprint 'schema_check: ' + str(${schema_check})\n### HARD-CODE while schemas are really different ###\n##context.updateVariable('schema_check',  1 ) \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314477":{"id":314477,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-1193,"y":-120,"width":32,"height":32,"inputConnectorIDs":[314527],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[314540],"outputFalseConnectorIDs":[314542],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does Source Schema Match Staging ?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314478":{"id":314478,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-726,"y":-118,"width":32,"height":32,"inputConnectorIDs":[314523],"outputSuccessConnectorIDs":[314525],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Staging"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables \n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere table_schema='${staging_schema}' and \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name=lower('${table_name}') )\n\t\t\tthen 1::smallint else 0::smallint end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314479":{"id":314479,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-878,"y":-112,"width":32,"height":32,"inputConnectorIDs":[314525],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[314538],"outputFalseConnectorIDs":[314543],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does it Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_exists"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314480":{"id":314480,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-937,"y":48,"width":32,"height":32,"inputConnectorIDs":[314514],"outputSuccessConnectorIDs":[314515],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for Table in Datamart"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"landing_cursor = context.cursor()\n \n\nlanding_cursor.execute(''' select case when  exists (select 1  from information_schema.tables where table_schema='${datamart_schema}' and \n\t\t\t\t\t\t\t\t\ttable_type='BASE TABLE' and table_name=lower('${table_name}') )\n\t\t\tthen 1 else 0 end as checker  ''' )\n\n\nresults = landing_cursor.fetchone()[0]\n \nprint 'does table exist: ', results\ncontext.updateVariable('table_exists',  results )\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314481":{"id":314481,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-942,"y":130,"width":32,"height":32,"inputConnectorIDs":[314515],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[314539],"outputFalseConnectorIDs":[314541],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Does Target Exist?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"schema_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314482":{"id":314482,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-1108,"y":212,"width":32,"height":32,"inputConnectorIDs":[314513],"outputSuccessConnectorIDs":[314520],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug 4"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_BASH","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho \" ***********  Debug 4 ******************\"\necho \"table: \" $table_name\necho \"job_id: \" $etl_job_id\necho \"auditid: \" $etl_audit_id\necho \"etl_where: \" $etl_where_logic\necho \"get_max_dates\" $get_max_date_sql\n \n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314483":{"id":314483,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-877,"y":-34,"width":32,"height":32,"inputConnectorIDs":[314543],"outputSuccessConnectorIDs":[314509],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Staging Table Missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\nStaging table missing'\nwhere etl_audit_id = ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314484":{"id":314484,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-799,"y":127,"width":32,"height":32,"inputConnectorIDs":[314541],"outputSuccessConnectorIDs":[314517],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit: DM Table Missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = 'datamart table missing'\nwhere etl_audit_id = '${etl_audit_id}'"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314485":{"id":314485,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1202,"y":-32,"width":32,"height":32,"inputConnectorIDs":[314542],"outputSuccessConnectorIDs":[314533],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit: Schema Change"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = status + '\\r\\n Schema Diff encountered: ${schema_change_columns} '\nwhere etl_audit_id =  ${etl_audit_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314486":{"id":314486,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1094,"y":128,"width":32,"height":32,"inputConnectorIDs":[314539],"outputSuccessConnectorIDs":[314531],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Staging Columns for Prod"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"columns = '${table_columns}'.replace(', \"stage_date\"',' ').replace('\"stage_date\",',' ')\n#print 'table_columns : ' + columns\ncontext.updateVariable('table_columns',  columns )\n\n## $table_columns_prefixed will be used for the dynamic UPSERT logic\n\ncolumns = '${table_columns_prefixed}'.replace(', s.\"stage_date\"',' ').replace('s.\"stage_date\",',' ')\n#print 'table_columns_prefixed : ' + columns\ncontext.updateVariable('table_columns_prefixed',  columns )"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314487":{"id":314487,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1371,"y":203,"width":32,"height":32,"inputConnectorIDs":[314535],"outputSuccessConnectorIDs":[314516],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add Stage Updates to Prod"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--UPDATE (mark same natural pk rows as expired)\nupdate datamart.${table_name}  \n\tset is_active=0, eff_date_end=getdate()\nfrom staging.${table_name} s inner join datamart.${table_name} d \non ${matched_keys}\nwhere s.audit_id = ${etl_audit_id} and s.etl_status is null;\n\n-- INSERT the same natural pk rows as active \ninsert into datamart.${table_name}\n( ${table_columns}, eff_date_start, eff_date_end, is_active )\n\nselect distinct  ${table_columns_prefixed}, getdate(), '9999-01-01'::timestamp, 1\n from  staging.${table_name} s inner join datamart.${table_name} d\non ${matched_keys}\nwhere  s.audit_id = ${etl_audit_id} and s.etl_status is null;\n\n--************************** update Staging \"source\"\nupdate staging.${table_name}\n\tset etl_status='U'\nfrom  staging.${table_name} s inner join datamart.${table_name} d \non ${matched_keys}\nwhere s.audit_id = ${etl_audit_id}  and s.etl_status is null "}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314488":{"id":314488,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1145,"y":-221,"width":32,"height":32,"inputConnectorIDs":[314521],"outputSuccessConnectorIDs":[314522],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set Cust_id Logic"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\n## customer_id=-1 --> ensures pulling all customers from crm tables\n\nif 'ble' in '${source_db}'.lower()  :\n    print  \"process customer_id \" + str(${crm_customer_id})  \n    context.updateVariable('crm_customer_id_plumb', str(${crm_customer_id}) + ' as crm_customer_id, ')\nelse:\n    ##print 'else'\n    context.updateVariable('crm_customer_id_plumb', ' ')\n \n \n## set fully_qualifed_table_name for component operations that require a schema.table_name reference \n##print 'fully_qualifed_table_name: ' + '${datamart_schema}'+'.'+'${table_name}'\ncontext.updateVariable('fully_qualifed_table_name', '${datamart_schema}'+'.'+'${table_name}')  \n  \n  \n\n\n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314489":{"id":314489,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1412,"y":-224,"width":32,"height":32,"inputConnectorIDs":[314526],"outputSuccessConnectorIDs":[314519],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"set Upper Limit"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## SET Upper Limit\n\nimport datetime\nimport time\n\ncursor = context.cursor()\n\n##important change10/6/2017\n##cursor.execute('''select DATEADD(HOUR,-4, GETDATE())  as gdate''')\n## this was python formating required\n## ##print 'upper_datetime_boundary: ' + result[0].strftime(\"%Y-%m-%d %H:%M:%S.%f\")  \n## GETDATE IGNORES the milliseconds\n\ncursor.execute('''select to_char(DATEADD(HOUR,-4, sysdate), 'YYYY-MM-DD HH24:MI:SS.MS') as gdate''')\n\nresult = cursor.fetchone()\nprint 'upper_datetime_boundary: ' + result[0] \n   \ncontext.updateVariable('upper_datetime_boundary', result[0] )\n\ntime.sleep(5)   # delays for 5 seconds\n \n\nwc0 = ''\nwc1 = ''\nall_wc = ''\n\nif not '${max_create_column}' : \t\n\tpass\nelse:\n   wc0 =    '${max_create_column}'  + ' < ' + '\\'' + result[0]   + '\\''\n\nif not '${max_update_column}' : \t\n\tpass\nelse:\n  \twc1 =  '${max_update_column}'  + ' < ' + '\\'' + result[0]  + '\\''  \n    \nif wc0 == '' and wc1 == '':\n\tall_wc = '(1=1)'\nelif wc0 == '':\n\tall_wc = '  (' + wc1 + ')'\nelif wc1 == '':\n\tall_wc =  '  (' + wc0 + ')'\nelse:\n \tall_wc =  ' ( ' + wc0 + ' and ' + wc1 +')'\n    \nprint 'all_wc' + all_wc  \nprint 'updated etl_where_logic: ' + etl_where_logic + ' and ' + all_wc \ncontext.updateVariable('etl_where_logic', etl_where_logic +' and '+ all_wc )\n  "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314490":{"id":314490,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1240,"y":127,"width":32,"height":32,"inputConnectorIDs":[314531],"outputSuccessConnectorIDs":[314528],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug INSERTS"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"print \" \"\nprint \"insert into datamart.${table_name}\"\na = \"(  \" + ${table_columns} + \" , eff_date_start, eff_date_end, is_active )\"\n\nprint a\n\nb = \"select distinct \"  + '${table_columns_prefixed}' +\" , getdate(), '9999-01-01'::timestamp, 1\"\nprint b\nc = \" from  staging.\"+'${table_name}' +\" s left join datamart.${table_name} d \"\nprint c\nprint \"on ${matched_keys}\"\nprint \"where  ${matched_is_null} s.audit_id = ${etl_audit_id} and s.etl_status is null;\"\nprint \" \"\nprint \" update staging.${table_name}\"\nprint \"\tset etl_status='I'\"\nprint \"from  staging.${table_name} s inner join datamart.${table_name} d \"\nprint \"on ${matched_keys}\"\nprint \"where s.audit_id =d.audit_id and s.etl_status is null ;\""}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314491":{"id":314491,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1502,"y":213,"width":32,"height":32,"inputConnectorIDs":[314506],"outputSuccessConnectorIDs":[314535],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Debug UPDATES"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"print \" \" \nprint \"update datamart.${table_name}  \"\nprint \"\tset is_active=0, eff_date_end=getdate()\"\nprint \"from staging.${table_name} s inner join datamart.${table_name} d \"\nprint \"on \" + '${matched_keys}' \nprint \"where s.audit_id = ${etl_audit_id} and s.etl_status is null;\"\n\nprint \" INSERT the same natural pk rows as active rows\"\nprint \"insert into datamart.${table_name}\"\nprint \"(\" + '${table_columns}' + \", eff_date_start, eff_date_end, is_active )\"\n\nprint \"select distinct \"+ '${table_columns_prefixed}' +\", getdate(), '9999-01-01'::timestamp, 1\"\nprint \" from  staging.${table_name} s inner join datamart.${table_name} d\"\nprint \"on ${matched_keys}\"\nprint \"where  s.audit_id = ${etl_audit_id} and s.etl_status is null;\"\n\nprint \" update Staging  source\"\nprint \"update staging.${table_name}\"\nprint \"\tset etl_status='U'\"\nprint \"from  staging.${table_name} s inner join datamart.${table_name} d \"\nprint \"on ${matched_keys}\"\nprint \"where s.audit_id = ${etl_audit_id}  and s.etl_status is null \""}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314492":{"id":314492,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1286,"y":-226,"width":32,"height":32,"inputConnectorIDs":[314519],"outputSuccessConnectorIDs":[314521],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Once Off Retrieval Override"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## \n\n##audit_upload_timecoalesce(once_off_retrieval_logic_flag,0) once_off_retrieval_logic_flag\n\nretrieval_sql= '${once_off_retrieval_logic_sql}'\nretrieval_sql = retrieval_sql.strip()\nthis_list=\"\"\n\nif ${once_off_retrieval_logic_flag}:\n\tprint \"Once-Off Logic Enabled\"\n\tcursor = context.cursor()\n\tcursor.execute('''select contactId from landing.once_off_contacts''')\n\tresult = cursor.fetchall()\n\n\tfor row in result:\n\t\tthis_list += str(row[0]) + \", \"\n    \n\tthis_list = \"where contactId in (\" + this_list[:-2] + \")\"\n \n \tif this_list:\n\t\tprint \"ONCE OFF Retrieval Override SET\"\n\t\tprint this_list\n\t\tcontext.updateVariable('etl_where_logic', this_list )\n\telse:\n\t\tprint \"false\"\nelse:\n  \tprint \"Once-Off Logic Disabled\""}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314493":{"id":314493,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-964,"y":211,"width":32,"height":32,"inputConnectorIDs":[314520],"outputSuccessConnectorIDs":[314534],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ETLJob OnceOff Reset"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_job\nset once_off_retrieval_logic_flag=0\nwhere job_id = ${etl_job_id}"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314494":{"id":314494,"inputCardinality":"ONE","outputCardinality":"ONE","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-537112080,"x":-665,"y":204,"width":32,"height":32,"inputConnectorIDs":[314537],"outputSuccessConnectorIDs":[314508],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Vacuum Table"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Tables to Vacuum","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Vacuum Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datamart"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314495":{"id":314495,"inputCardinality":"ONE","outputCardinality":"ONE","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-857923225,"x":-561,"y":211,"width":32,"height":32,"inputConnectorIDs":[314508],"outputSuccessConnectorIDs":[314529],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Analyze Tables 0"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Tables to Analyze","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table_name}"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datamart"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314496":{"id":314496,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-837,"y":211,"width":32,"height":32,"inputConnectorIDs":[314534],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[314537],"outputFalseConnectorIDs":[314544],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Was Target Updated?"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Mode","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Condition","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"audit_rowcount"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Combine Conditions","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Condition","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314497":{"id":314497,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":-666,"y":311,"width":32,"height":32,"inputConnectorIDs":[314532],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314498":{"id":314498,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1506,"y":123,"width":32,"height":32,"inputConnectorIDs":[314511],"outputSuccessConnectorIDs":[314506],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT dm insert"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n datamart: inserts'\nwhere etl_audit_id = ${etl_audit_id} "}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314499":{"id":314499,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1231,"y":211,"width":32,"height":32,"inputConnectorIDs":[314516],"outputSuccessConnectorIDs":[314513],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT dm UPDATES"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"SQL Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update admin.etl_audit\nset status = coalesce(status,'') + '\\r\\n datamart: updates'\nwhere etl_audit_id = ${etl_audit_id} "}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314500":{"id":314500,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-1033,"y":-37,"width":32,"height":32,"inputConnectorIDs":[314533],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Msg: Schema Change"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"AWS Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Topic Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dev-etl-crm"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Subject","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification for environment: ${environment}"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Message","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"It appears the source schema for table: ${table_name} is different from the Staging Schema.\nThis ETL job will not be run.\nPlease verify."}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314501":{"id":314501,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-728,"y":-30,"width":32,"height":32,"inputConnectorIDs":[314509],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Msg : Staging missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"AWS Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Topic Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dev-etl-crm"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Subject","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification for environment: ${environment}"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Message","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"The Staging schema for table: ${table_name} is Missing.\nThis ETL job will not be run.\nPlease verify."}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314502":{"id":314502,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-647,"y":126,"width":32,"height":32,"inputConnectorIDs":[314517],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Msg : Datamart missing"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"AWS Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Topic Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dev-etl-crm"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Subject","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification for environment: ${environment}"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Message","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"the Datamart schema for table: ${table_name} is Missing.\nThis ETL job will not be run.\nPlease verify."}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314503":{"id":314503,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":-839,"y":304,"width":32,"height":32,"inputConnectorIDs":[314544],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Success No Update"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314504":{"id":314504,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1398,"y":43,"width":32,"height":32,"inputConnectorIDs":[314530],"outputSuccessConnectorIDs":[314536],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gen Insert Metadata"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cursor = context.cursor()\n\ntablename='landing.${table_name}'\n#print tablename\n \n## check for any transformations \nsql =\"SELECT  attname::varchar column_name,  coalesce(t.transformation,'') trans, coalesce(t.column_name_as,'') col_alias  FROM pg_attribute p left join admin.etl_job_transform t on p.attname::varchar = t.column_name  WHERE  attrelid = '{}'::regclass AND  (attnum > 0) AND (NOT attisdropped)   and {} = coalesce(t.job_id,{})  order by attnum  \".format(tablename, ${etl_job_id}, ${etl_job_id} )  \n \n## for testing\n##sql=\" SELECT  attname::varchar column_name,  coalesce(t.transformation,'') transs, coalesce(t.column_name_as,'') col_alias FROM pg_attribute p left join admin.etl_job_transform t on p.attname::varchar = t.column_name  WHERE  attrelid = 'datamart.campaigns_ii'::regclass AND  (attnum > 0) AND (NOT attisdropped)   and 49=coalesce(49,0) order by attnum  \"\n  \n## delimit the column-names with \"column\" to cover for columns that are reserved words/ otherwise the insert will fail\njoin_columns = ''\nins_columns='' \nsel_columns=''\n\n#print sql\ncursor.execute(sql)\n##row[0] will always contain the column_name\n##row[1] contains the transformation, if exists\n##row[2] alias, if exists\n################################\nfor row in cursor:\n##check for the transformation\n\tif row[1]:\t\t\n  \t\tsel_columns += row[1] \n  \telse:\n\t\tsel_columns += '\"'+row[0]+'\"'  \n   \n##check for an alias\n\tif row[2]:\n\t\ttarget_column = row[2]\n\t\talias = row[2]\n\telse:\n\t\ttarget_column= row[0]\t\n\t\talias = ' '\n\n\tsel_columns += alias+', '\t\t\t\n\tins_columns += '\"'+target_column+'\"'  +', ' \n\tjoin_columns += 's.\"'+target_column+'\"'  +', '\n##################################################### \n    \n## strip -off the extra trailing  ', '    \nins_columns = ins_columns[:-2]\nsel_columns = sel_columns[:-2]\njoin_columns = join_columns[:-2]\n\ninsert_sql = 'insert into staging.${table_name} ( '+ ins_columns +')  ' +  ' select ' + sel_columns +' from landing.${table_name} '\nprint ''\nprint 'table_columns: ' + ins_columns \nprint ' '\nprint 'sel_columns: ' + sel_columns \nprint ' '\nprint 'table_columns_prefixed: ' + join_columns\nprint ' '\nprint 'insert_sql: ' + insert_sql\n \ncontext.updateVariable('insert_sql',  insert_sql )\ncontext.updateVariable('table_columns',  ins_columns )\ncontext.updateVariable('table_columns_prefixed',  join_columns )\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"314505":{"id":314505,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1513,"y":-192,"width":32,"height":32,"inputConnectorIDs":[314524],"outputSuccessConnectorIDs":[314526],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Set Lower Limit"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Script","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_PYTHON","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"## SET Lower date boundary for retrieval\n\nlow_date_value\ncursor = context.cursor()\n## customer_id=-1 --> ensures pulling all customers from crm tables\n\ncursor.execute('''select to_char(max(max_create_date), 'YYYY-MM-DD HH24:MI:SS.MS') max_create_date, \n\t\t\t\t\t\t to_char(max(max_update_date), 'YYYY-MM-DD HH24:MI:SS.MS') max_update_date\n\t\t\t\t  from\n\t\t\t\t( \n\t\t\t\t\tselect coalesce(max_create_date, to_timestamp('${low_date_value}', 'YYYY-MM-DD')) max_create_date,  \n\t\t\t\t\t       coalesce(max_update_date, to_timestamp('${low_date_value}', 'YYYY-MM-DD')) max_update_date\t\n\t\t\t\t\tfrom admin.etl_audit \n\t\t\t\t\twhere etl_audit_id = ( \n                          \tselect max(etl_audit_id) from admin.etl_audit \n                            where coalesce(row_count,0) > 0 and job_id ='${etl_job_id}' and customer_id=${crm_customer_id}\n                          )\n\t\t\t\t\tunion \n\t\t\t\t\tselect \tto_timestamp('${low_date_value}', 'YYYY-MM-DD') max_create_date,  \n\t\t\t\t\t\t\tto_timestamp('${low_date_value}', 'YYYY-MM-DD') max_update_date\n\t\t\t\t) '''\n            )\t\n\nimport datetime \n\nresult = cursor.fetchone()\nprint result \n\nr0 =  result[0]\nr1 =  result[1]\n\nif not r0:\n  r0='${low_date_value}'\n  \nif not r1:\n  r1='${low_date_value}'\n  \n  \nwc0=''\nwc1=''\nall_wc=''\n\nif not '${max_create_column}' : \t\n\tpass\nelse:\n   \twc0 = '${max_create_column}' + ' > ' + '\\'' + r0 + '\\''\n    \nif not '${max_update_column}' : \t\n\tpass\nelse:\n   \twc1 = '${max_update_column}' + ' > ' + '\\'' + r1 + '\\''\n\n\nif wc0 == '' and wc1 == '':\n\tall_wc = ' where (1=1)  '\nelif wc0 == '':\n\tall_wc = ' where (' + wc1 +')'\nelif wc1 == '':\n\tall_wc =  ' where (' + wc0 +')'\nelse:\n \tall_wc =  ' where (' + wc0 + ' or ' + wc1+ ')'\n\n    \nprint 'wc0: ' + wc0\nprint 'wc1: ' + wc1\nprint 'etl_where_logic: ' + all_wc   \ncontext.updateVariable('etl_where_logic', all_wc)\n\n \n "}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Interpreter","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Timeout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"314508":{"id":314508,"sourceID":314494,"targetID":314495},"314509":{"id":314509,"sourceID":314483,"targetID":314501},"314510":{"id":314510,"sourceID":314466,"targetID":314468},"314511":{"id":314511,"sourceID":314473,"targetID":314498},"314506":{"id":314506,"sourceID":314498,"targetID":314491},"314507":{"id":314507,"sourceID":314470,"targetID":314471},"314516":{"id":314516,"sourceID":314487,"targetID":314499},"314517":{"id":314517,"sourceID":314484,"targetID":314502},"314518":{"id":314518,"sourceID":314472,"targetID":314474},"314519":{"id":314519,"sourceID":314489,"targetID":314492},"314512":{"id":314512,"sourceID":314471,"targetID":314466},"314513":{"id":314513,"sourceID":314499,"targetID":314482},"314514":{"id":314514,"sourceID":314474,"targetID":314480},"314515":{"id":314515,"sourceID":314480,"targetID":314481},"314524":{"id":314524,"sourceID":314467,"targetID":314505},"314525":{"id":314525,"sourceID":314478,"targetID":314479},"314526":{"id":314526,"sourceID":314505,"targetID":314489},"314527":{"id":314527,"sourceID":314476,"targetID":314477},"314520":{"id":314520,"sourceID":314482,"targetID":314493},"314521":{"id":314521,"sourceID":314492,"targetID":314488},"314522":{"id":314522,"sourceID":314488,"targetID":314470},"314523":{"id":314523,"sourceID":314468,"targetID":314478},"314532":{"id":314532,"sourceID":314475,"targetID":314497},"314533":{"id":314533,"sourceID":314485,"targetID":314500},"314534":{"id":314534,"sourceID":314493,"targetID":314496},"314535":{"id":314535,"sourceID":314491,"targetID":314487},"314528":{"id":314528,"sourceID":314490,"targetID":314473},"314529":{"id":314529,"sourceID":314495,"targetID":314475},"314530":{"id":314530,"sourceID":314469,"targetID":314504},"314531":{"id":314531,"sourceID":314486,"targetID":314490},"314536":{"id":314536,"sourceID":314504,"targetID":314472}},"failureConnectors":{},"unconditionalConnectors":{"314545":{"id":314545,"sourceID":314465,"targetID":314467}},"trueConnectors":{"314540":{"id":314540,"sourceID":314477,"targetID":314469},"314537":{"id":314537,"sourceID":314496,"targetID":314494},"314538":{"id":314538,"sourceID":314479,"targetID":314476},"314539":{"id":314539,"sourceID":314481,"targetID":314486}},"falseConnectors":{"314544":{"id":314544,"sourceID":314496,"targetID":314503},"314541":{"id":314541,"sourceID":314481,"targetID":314484},"314542":{"id":314542,"sourceID":314477,"targetID":314485},"314543":{"id":314543,"sourceID":314479,"targetID":314483}},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Rename Job","undoCreated":1512443237586,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"314463":{"id":314463,"x":-668,"y":-303,"width":250,"height":58,"text":"if schema has changed ,end flow for this job,\nTODO: make sure to log this and/or send warning"}}},{"id":190589,"revision":40,"created":1510855822633,"timestamp":1510855822633,"components":{"190590":{"id":190590,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-592,"y":-7,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[190598],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"190593":{"id":190593,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-2044786085,"x":-430,"y":0,"width":32,"height":32,"inputConnectorIDs":[190598],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"S3 Unload 0"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customer_list"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"S3 URL Location","editorHint":"S3_URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://com.hlc.etltest/test/"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"S3 Object Prefix","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"demo"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Generate Manifest","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Data File Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delimited"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Delimiter","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"*"}}}},"visible":true,"status":{}},"8":{"slot":8,"name":"Fixed Width Spec","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"9":{"slot":9,"name":"Compress Data","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"10":{"slot":10,"name":"Null As","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\\\\N"}}}},"visible":true,"status":{}},"11":{"slot":11,"name":"Escape","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"12":{"slot":12,"name":"Allow Overwrites","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"13":{"slot":13,"name":"Parallel","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"14":{"slot":14,"name":"Add Quotes","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"15":{"slot":15,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{}},"16":{"slot":16,"name":"","editorHint":"SINGLE_VALUE_FREEFORM","elements":{},"visible":false,"status":{}},"17":{"slot":17,"name":"","editorHint":"SINGLE_VALUE_FREEFORM","elements":{},"visible":false,"status":{}},"18":{"slot":18,"name":"IAM Role Arn","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"arn:aws:iam::<aws-account-id>:role/<role-name>"}}}},"visible":true,"status":{}},"40000":{"slot":40000,"name":"Encryption","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"40001":{"slot":40001,"name":"KMS Key ID","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"190598":{"id":190598,"sourceID":190590,"targetID":190593}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1510855814397,"canRedo":false,"redoCommand":"","redoCreated":1510855573242,"notes":{}},{"id":190644,"revision":58,"created":1510856674614,"timestamp":1510856674614,"components":{"190645":{"id":190645,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-522,"y":-39,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[292770],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"190649":{"id":190649,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1449697230,"x":-242,"y":-29,"width":32,"height":32,"inputConnectorIDs":[292772],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"S3 Load 0"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"Target Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customer_list"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Load Columns","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_name"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"active_flag"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"source_db"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"source_server"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"note"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"S3 URL Location","editorHint":"S3_URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://com.hlc.etltest/test/"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"S3 Object Prefix","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Data File Type","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delimited"}}}},"visible":true,"status":{}},"7":{"slot":7,"name":"Fixed Width Spec","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"8":{"slot":8,"name":"Delimiter","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"*"}}}},"visible":true,"status":{}},"9":{"slot":9,"name":"CSV Quoter","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":false,"status":{}},"10":{"slot":10,"name":"JSON Layout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto"}}}},"visible":false,"status":{}},"11":{"slot":11,"name":"Region","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"13":{"slot":13,"name":"Compression Method","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"14":{"slot":14,"name":"Encoding","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UTF8"}}}},"visible":true,"status":{}},"15":{"slot":15,"name":"Remove Quotes","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"16":{"slot":16,"name":"Replace Invalid Characters","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":"?"}}}},"visible":true,"status":{}},"17":{"slot":17,"name":"Maximum Errors","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"0"}}}},"visible":true,"status":{}},"18":{"slot":18,"name":"Date Format","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto"}}}},"visible":true,"status":{}},"19":{"slot":19,"name":"Time Format","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto"}}}},"visible":true,"status":{}},"20":{"slot":20,"name":"Ignore Header Rows","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"0"}}}},"visible":true,"status":{}},"21":{"slot":21,"name":"Accept Any Date","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"22":{"slot":22,"name":"Ignore Blank Lines","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"23":{"slot":23,"name":"Truncate Columns","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"24":{"slot":24,"name":"Fill Record","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"25":{"slot":25,"name":"Trim Blanks","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"26":{"slot":26,"name":"NULL As","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\\\\N"}}}},"visible":true,"status":{}},"27":{"slot":27,"name":"Empty As Null","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"28":{"slot":28,"name":"Blanks As Null","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"29":{"slot":29,"name":"Comp Update","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true,"status":{}},"30":{"slot":30,"name":"Stat Update","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true,"status":{}},"31":{"slot":31,"name":"Escape","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"32":{"slot":32,"name":"Round Decimals","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}},"33":{"slot":33,"name":"Manifest","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"34":{"slot":34,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"work"}}}},"visible":true,"status":{}},"35":{"slot":35,"name":"","editorHint":"SINGLE_VALUE_FREEFORM","elements":{},"visible":false,"status":{}},"36":{"slot":36,"name":"","editorHint":"SINGLE_VALUE_FREEFORM","elements":{},"visible":false,"status":{}},"37":{"slot":37,"name":"Explicit IDs","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{}},"38":{"slot":38,"name":"IAM Role ARN","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"arn:aws:iam::<aws-account-id>:role/<role-name>"}}}},"visible":true,"status":{}},"112":{"slot":112,"name":"Avro Layout","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto"}}}},"visible":false,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"292764":{"id":292764,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":-403,"y":-25,"width":32,"height":32,"inputConnectorIDs":[292770],"outputSuccessConnectorIDs":[292772],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create/Replace Table 0"}}}},"visible":true,"status":{}},"2":{"slot":2,"name":"New Table Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customer_list"}}}},"visible":true,"status":{}},"3":{"slot":3,"name":"Create/Replace","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create if not exists"}}}},"visible":true,"status":{}},"4":{"slot":4,"name":"Table Metadata","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"Integer"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_name"},"2":{"slot":2,"type":"STRING","value":"Text"},"3":{"slot":3,"type":"INTEGER","value":"255"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"active_flag"},"2":{"slot":2,"type":"STRING","value":"Boolean"},"3":{"slot":3,"type":"INTEGER","value":"1"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"source_db"},"2":{"slot":2,"type":"STRING","value":"Text"},"3":{"slot":3,"type":"INTEGER","value":"32"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"source_server"},"2":{"slot":2,"type":"STRING","value":"Text"},"3":{"slot":3,"type":"INTEGER","value":"32"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"note"},"2":{"slot":2,"type":"STRING","value":"Text"},"3":{"slot":3,"type":"INTEGER","value":"1000"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"}}}},"visible":true,"status":{}},"5":{"slot":5,"name":"Distribution Style","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true,"status":{}},"6":{"slot":6,"name":"Distribution Key","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{}},"7":{"slot":7,"name":"Sort Key","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{}},"8":{"slot":8,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"work"}}}},"visible":true,"status":{}},"9":{"slot":9,"name":"Primary Key","editorHint":"LIST_FROM_OPTIONS","elements":{},"visible":true,"status":{}},"11":{"slot":11,"name":"Identity Columns","editorHint":"GENERIC_GRID","elements":{},"visible":true,"status":{}},"14":{"slot":14,"name":"Sort Key Options","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false,"status":{}},"15":{"slot":15,"name":"Backup Table","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"292772":{"id":292772,"sourceID":292764,"targetID":190649}},"failureConnectors":{},"unconditionalConnectors":{"292770":{"id":292770,"sourceID":190645,"targetID":292764}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1510856653899,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{}},{"id":292879,"revision":3,"created":1510855235820,"timestamp":1510855235820,"components":{"292880":{"id":292880,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-338,"y":-74,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{}}},"validationStatus":{},"status":{},"expectedFailure":null,"outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Move Components","undoCreated":1510855230028,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{}}],"transformationJobs":[{"id":165768,"revision":66,"created":1509668338861,"timestamp":1509668338861,"components":{"165769":{"id":165769,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":-930,"y":46,"width":32,"height":32,"inputConnectorIDs":[200619],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ETL Audit"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Target Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_audit"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Fix Data Type Mismatches","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_job_id"},"2":{"slot":2,"type":"STRING","value":"job_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"customer_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_date"},"2":{"slot":2,"type":"STRING","value":"max_create_date"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_date"},"2":{"slot":2,"type":"STRING","value":"max_update_date"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"status"},"2":{"slot":2,"type":"STRING","value":"status"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Truncate","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"6":{"slot":6,"name":"Automatic Compression","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"7":{"slot":7,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"165770":{"id":165770,"inputCardinality":"ZERO","outputCardinality":"ONE","implementationID":738944573,"x":-1202,"y":43,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[200616],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Map Initialize Values"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Columns","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_job_id"},"2":{"slot":2,"type":"STRING","value":"Numeric"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"Numeric"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_date"},"2":{"slot":2,"type":"STRING","value":"DateTime"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_date"},"2":{"slot":2,"type":"STRING","value":"DateTime"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Values","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"DECIMAL","value":"${etl_job_id}"},"2":{"slot":2,"type":"STRING","value":"${crm_customer_id}"},"3":{"slot":3,"type":"STRING","value":"${low_date_value}"},"4":{"slot":4,"type":"STRING","value":"${low_date_value}"},"5":{"slot":5,"type":"DATETIME","value":"${audit_started}"},"6":{"slot":6,"type":"DATETIME","value":"${audit_completed}"},"7":{"slot":7,"type":"DECIMAL","value":"${audit_rowcount} "},"8":{"slot":8,"type":"DECIMAL","value":"${audit_duration} "},"9":{"slot":9,"type":"DECIMAL","value":"${audit_upload_time}"},"10":{"slot":10,"type":"DECIMAL","value":"${audit_copy_time}  "}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"200609":{"id":200609,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-1049,"y":49,"width":32,"height":32,"inputConnectorIDs":[200616],"outputConnectorIDs":[200619],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Include Input Columns","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Calculations","editorHint":"EXPRESSION_EDITOR","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'ETL: Initialize'::text"},"2":{"slot":2,"type":"STRING","value":"status"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null}},"connectors":{"200619":{"id":200619,"sourceID":200609,"targetID":165769},"200616":{"id":200616,"sourceID":165770,"targetID":200609}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1504847630701,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{}},{"id":166812,"revision":236,"created":1513197548899,"timestamp":1513197548899,"components":{"166813":{"id":166813,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-2,"y":19,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[171526],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Max Dates Record"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"SQL Query","editorHint":"SINGLE_VALUE_FREEFORM_TEXTAREA_SQL_UPGRADE","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select ${etl_audit_id} as audit_id, ${get_max_dates_sql} from ${landing_schema}.${table_name} with (nolock)"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"166814":{"id":166814,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":165,"y":15,"width":32,"height":32,"inputConnectorIDs":[171526],"outputConnectorIDs":[171529],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MaxDates"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Include Input Columns","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Calculations","editorHint":"EXPRESSION_EDITOR","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'${table_name}'"},"2":{"slot":2,"type":"STRING","value":"table_name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(max_create_date,'1900-01-01')"},"2":{"slot":2,"type":"STRING","value":"max_create"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(max_update_date,'1900-01-01')"},"2":{"slot":2,"type":"STRING","value":"max_update"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"166815":{"id":166815,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":505,"y":-51,"width":32,"height":32,"inputConnectorIDs":[171532],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etlaudit"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Target Table Name","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_audit"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Fix Data Type Mismatches","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Column Mapping","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"max_create_date"},"2":{"slot":2,"type":"STRING","value":"max_create_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"max_update_date"},"2":{"slot":2,"type":"STRING","value":"max_update_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"audit_id"},"2":{"slot":2,"type":"STRING","value":"etl_audit_id"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"started"},"2":{"slot":2,"type":"STRING","value":"etl_start"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"completed"},"2":{"slot":2,"type":"STRING","value":"etl_end"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rows"},"2":{"slot":2,"type":"STRING","value":"row_count"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"audit_upload_time"},"2":{"slot":2,"type":"STRING","value":"audit_upload_time"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"audit_copy_time"},"2":{"slot":2,"type":"STRING","value":"audit_copy_time"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"status"},"2":{"slot":2,"type":"STRING","value":"status"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"customer_id"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Unique Keys","editorHint":"LIST_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_audit_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"6":{"slot":6,"name":"Schema","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"admin"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"7":{"slot":7,"name":"Update Strategy","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"167119":{"id":167119,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":261,"y":-49,"width":32,"height":32,"inputConnectorIDs":[192314,171529],"outputConnectorIDs":[171532],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Main Table","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Main Table Alias","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"a"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"4":{"slot":4,"name":"Joins","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MaxDates"},"2":{"slot":2,"type":"STRING","value":"d"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"5":{"slot":5,"name":"Join Expressions","editorHint":"JOIN_EDITOR","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"a.audit_id = d.audit_id"},"2":{"slot":2,"type":"STRING","value":"a_Inner_d"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"6":{"slot":6,"name":"Output Columns","editorHint":"GENERIC_GRID_AUTOPOP","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"a.set_status"},"2":{"slot":2,"type":"STRING","value":"status"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"a.started"},"2":{"slot":2,"type":"STRING","value":"started"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"a.completed"},"2":{"slot":2,"type":"STRING","value":"completed"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"a.rows"},"2":{"slot":2,"type":"STRING","value":"rows"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"a.audit_upload_time"},"2":{"slot":2,"type":"STRING","value":"audit_upload_time"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"a.audit_copy_time"},"2":{"slot":2,"type":"STRING","value":"audit_copy_time"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"d.max_create"},"2":{"slot":2,"type":"STRING","value":"max_create_date"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"d.max_update"},"2":{"slot":2,"type":"STRING","value":"max_update_date"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"a.audit_id"},"2":{"slot":2,"type":"STRING","value":"audit_id"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"a.customer_id"},"2":{"slot":2,"type":"STRING","value":"customer_id"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"192308":{"id":192308,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":161,"y":-109,"width":32,"height":32,"inputConnectorIDs":[322138],"outputConnectorIDs":[192314],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Include Input Columns","editorHint":"SINGLE_VALUE_FROM_OPTIONS","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Calculations","editorHint":"EXPRESSION_EDITOR","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" 'data landing: success' "},"2":{"slot":2,"type":"STRING","value":"set_status"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null},"322135":{"id":322135,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":738944574,"x":-4,"y":-118,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[322138],"parameters":{"1":{"slot":1,"name":"Name","editorHint":"SINGLE_VALUE_FREEFORM","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed Flow 0"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"2":{"slot":2,"name":"Columns","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_job_id"},"2":{"slot":2,"type":"STRING","value":"Integer"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"},"2":{"slot":2,"type":"STRING","value":"Integer"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Status"},"2":{"slot":2,"type":"STRING","value":"Text"},"3":{"slot":3,"type":"INTEGER","value":"255"},"4":{"slot":4,"type":"INTEGER","value":""}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Started"},"2":{"slot":2,"type":"STRING","value":"DateTime"},"3":{"slot":3,"type":"INTEGER","value":"32"},"4":{"slot":4,"type":"INTEGER","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Completed"},"2":{"slot":2,"type":"STRING","value":"DateTime"},"3":{"slot":3,"type":"INTEGER","value":"32"},"4":{"slot":4,"type":"INTEGER","value":""}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Rows"},"2":{"slot":2,"type":"STRING","value":"Integer"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Upload_Time"},"2":{"slot":2,"type":"STRING","value":"Numeric"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":"2"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_Copy_Time"},"2":{"slot":2,"type":"STRING","value":"Numeric"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":"2"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"Audit_id"},"2":{"slot":2,"type":"STRING","value":"Integer"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}},"3":{"slot":3,"name":"Values","editorHint":"GENERIC_GRID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"BIGINT","value":"${etl_job_id}"},"2":{"slot":2,"type":"BIGINT","value":"${crm_customer_id}"},"3":{"slot":3,"type":"STRING","value":"${audit_status}"},"4":{"slot":4,"type":"DATETIME","value":"${audit_started}"},"5":{"slot":5,"type":"DATETIME","value":"${audit_completed}"},"6":{"slot":6,"type":"BIGINT","value":"${audit_rowcount} "},"7":{"slot":7,"type":"BIGINT","value":"${audit_upload_time}"},"8":{"slot":8,"type":"BIGINT","value":"${audit_copy_time}"},"9":{"slot":9,"type":"BIGINT","value":"${etl_audit_id}"}}}},"visible":true,"status":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}}}},"exportMappings":{},"validationStatus":{"190679":{"environmentID":190679,"validationState":"OK","validationMessage":""}},"expectedFailure":null}},"connectors":{"171526":{"id":171526,"sourceID":166813,"targetID":166814},"192314":{"id":192314,"sourceID":192308,"targetID":167119},"171529":{"id":171529,"sourceID":166814,"targetID":167119},"171532":{"id":171532,"sourceID":167119,"targetID":166815},"322138":{"id":322138,"sourceID":322135,"targetID":192308}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1513197505561,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{}},{"id":311357,"revision":2,"created":1512245130336,"timestamp":1512245130336,"components":{},"connectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{}},{"id":292884,"revision":2,"created":1510855255458,"timestamp":1510855255458,"components":{},"connectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{}}],"variables":[{"name":"audit_completed","type":"DATETIME","scope":"BRANCH"},{"name":"audit_component","type":"TEXT","scope":"BRANCH"},{"name":"audit_copy_time","type":"DECIMAL","scope":"BRANCH"},{"name":"audit_duration","type":"DECIMAL","scope":"BRANCH"},{"name":"audit_id_backup","type":"DECIMAL","scope":"BRANCH"},{"name":"audit_rowcount","type":"DECIMAL","scope":"BRANCH"},{"name":"audit_started","type":"DATETIME","scope":"BRANCH"},{"name":"audit_status","type":"TEXT","scope":"BRANCH"},{"name":"audit_upload_time","type":"DECIMAL","scope":"BRANCH"},{"name":"ble_database_name","type":"TEXT","scope":"TASKBATCH"},{"name":"cal_end_date","type":"TEXT","scope":"TASKBATCH"},{"name":"cal_number_of_years","type":"DECIMAL","scope":"TASKBATCH"},{"name":"crm_customer_id","type":"DECIMAL","scope":"BRANCH"},{"name":"crm_customer_id_plumb","type":"TEXT","scope":"BRANCH"},{"name":"datamart_schema","type":"TEXT","scope":"TASKBATCH"},{"name":"debugger","type":"TEXT","scope":"TASKBATCH"},{"name":"environment","type":"TEXT","scope":"TASKBATCH"},{"name":"etl_audit_id","type":"DECIMAL","scope":"BRANCH"},{"name":"etl_job_id","type":"DECIMAL","scope":"BRANCH"},{"name":"etl_where_logic","type":"TEXT","scope":"BRANCH"},{"name":"fully_qualifed_table_name","type":"TEXT","scope":"BRANCH"},{"name":"get_max_dates_sql","type":"TEXT","scope":"BRANCH"},{"name":"insert_sql","type":"TEXT","scope":"BRANCH"},{"name":"job_order","type":"DECIMAL","scope":"BRANCH"},{"name":"landing_schema","type":"TEXT","scope":"TASKBATCH"},{"name":"low_date_value","type":"DATETIME","scope":"TASKBATCH"},{"name":"low_value","type":"TEXT","scope":"BRANCH"},{"name":"match_keys","type":"TEXT","scope":"BRANCH"},{"name":"matched_is_null","type":"TEXT","scope":"BRANCH"},{"name":"matched_keys","type":"TEXT","scope":"BRANCH"},{"name":"max_create_column","type":"TEXT","scope":"BRANCH"},{"name":"max_update_column","type":"TEXT","scope":"BRANCH"},{"name":"once_off_retrieval_logic_flag","type":"DECIMAL","scope":"BRANCH"},{"name":"once_off_retrieval_logic_sql","type":"TEXT","scope":"BRANCH"},{"name":"rows_transferred","type":"DECIMAL","scope":"BRANCH"},{"name":"schema","type":"TEXT","scope":"TASKBATCH"},{"name":"schema_change_columns","type":"TEXT","scope":"BRANCH"},{"name":"schema_check","type":"DECIMAL","scope":"BRANCH"},{"name":"schema_clone","type":"TEXT","scope":"BRANCH"},{"name":"select_from_sql_x","type":"TEXT","scope":"BRANCH"},{"name":"source_db","type":"TEXT","scope":"BRANCH"},{"name":"source_server","type":"TEXT","scope":"BRANCH"},{"name":"staging_schema","type":"TEXT","scope":"TASKBATCH"},{"name":"table_columns","type":"TEXT","scope":"BRANCH"},{"name":"table_columns_prefixed","type":"TEXT","scope":"BRANCH"},{"name":"table_exists","type":"DECIMAL","scope":"BRANCH"},{"name":"table_name","type":"TEXT","scope":"BRANCH"},{"name":"total_count","type":"TEXT","scope":"BRANCH"},{"name":"upper_datetime_boundary","type":"DATETIME","scope":"BRANCH"}],"environments":[{"index":0,"name":"RedshiftProd","instanceCredentials":true,"credentialsName":"","schema":"landing","encrypted":false,"url":"red001pdw.cnsauolcfu6d.us-east-1.redshift.amazonaws.com","port":"5439","database":"prod","driver":null,"user":"svc_reddw_prod","passwordName":"","variables":{"debugger":null,"match_keys":"","low_value":"1","audit_status":"none","table_columns":"\"id\", \"campname\", \"notes\", \"createdby\", \"jsoncriteria\", \"audit_id\", \"stage_date\"","table_name":"contact_customdata","crm_customer_id":"-1","select_from_sql_x":null,"crm_customer_id_plumb":" ","landing_schema":"landing","schema_check":"-1","audit_upload_time":"-1","etl_where_logic":"","etl_audit_id":"2163","audit_id_backup":"-1","audit_completed":"1900-01-01","etl_job_id":"58","matched_is_null":"d.ID is null  and ","datamart_schema":"datamart","get_max_dates_sql":" max(date) as max_create_date,  max('1900-01-01') as max_update_date","source_server":"10.251.254.11","once_off_retrieval_logic_sql":"","cal_number_of_years":null,"schema":null,"audit_rowcount":"-1","max_create_column":" ","job_order":"1","matched_keys":" s.id=t.id ","fully_qualifed_table_name":"landing.contacts_history","schema_clone":null,"schema_change_columns":"","insert_sql":"select 1","table_columns_prefixed":"s.a,s.b,s.c","audit_started":"1900-01-01","rows_transferred":null,"audit_copy_time":"-1","staging_schema":"staging","table_exists":"","audit_component":"none","source_db":"bills_ble","total_count":null,"cal_end_date":null,"ble_database_name":"","environment":"DEV","audit_duration":"-1","upper_datetime_boundary":"1900-01-01 00:00:00","once_off_retrieval_logic_flag":"0","low_date_value":"1900-01-01","max_update_column":""}}]}